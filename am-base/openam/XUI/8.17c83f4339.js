(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{631:function(t,e,n){"use strict";var r,o=6e4,i=function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},a=function(){function t(){}return t.set=function(t){if(!this.isValid(t))throw new Error("Configuration is invalid");t.serverConfig&&this.validateServerConfig(t.serverConfig),this.options=i({},t)},t.get=function(t){if(!this.options&&!t)throw new Error("Configuration has not been set");var e=i(i({},this.options),t);if(!e.serverConfig||!e.serverConfig.baseUrl)throw new Error("Server configuration has not been set");return e},t.isValid=function(t){return!(!t||!t.serverConfig)},t.validateServerConfig=function(t){t.timeout||(t.timeout=o);var e=t.baseUrl;e&&"/"!==e.charAt(e.length-1)&&(t.baseUrl=e+"/")},t}();!function(t){t.Authenticate="AUTHENTICATE",t.Authorize="AUTHORIZE",t.Logout="LOGOUT",t.ExchangeToken="EXCHANGE_TOKEN",t.RefreshToken="REFRESH_TOKEN",t.RevokeToken="REVOKE_TOKEN",t.StartAuthenticate="START_AUTHENTICATE",t.UserInfo="USER_INFO"}(r||(r={}));function u(t,e){void 0===e&&(e=o);var n=e||o;return Promise.race([t,new Promise(function(t,e){return window.setTimeout(function(){return e(new Error("Timeout"))},n)})])}var c=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};function s(t){var e="http:"===t.protocol&&-1===["","80"].indexOf(t.port)||"https:"===t.protocol&&-1===["","443"].indexOf(t.port)?":"+t.port:"";return t.protocol+"//"+t.hostname+e}function l(t,e,n){var r=function(t){var e=(t||"").split("/").map(function(t){return t.trim()}).filter(function(t){return""!==t});return"root"!==e[0]&&e.unshift("root"),e.map(function(t){return"realms/"+t}).join("/")}(e),o={authenticate:"json/"+r+"/authenticate",authorize:"oauth2/"+r+"/authorize",accessToken:"oauth2/"+r+"/access_token",endSession:"oauth2/"+r+"/connect/endSession",userInfo:"oauth2/"+r+"/userinfo",revoke:"oauth2/"+r+"/token/revoke",sessions:"json/"+r+"/sessions/"};return n&&n[t]?n[t]:o[t]}function f(t,e){var n=new URL(t);if(e.startsWith("/"))return""+s(n)+e;var r=n.pathname.split("/"),o=e.split("/").filter(function(t){return!!t}),i=c(r.slice(0,-1),o).join("/");return""+s(n)+i}function p(t){var e=[];for(var n in t)t[n]&&e.push(n+"="+encodeURIComponent(t[n]));return e.join("&")}var d,h,y=function(t,e,n){var r=a.get().middleware;if(!Array.isArray(r))return t;var o=Object.freeze({type:e,payload:n}),i=r.map(function(t){return t});return function e(){var n=i.shift();return n&&n(t,o,e),t}()},v=function(){return(v=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},g=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}c((r=r.apply(t,e||[])).next())})},b=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},w=function(){function t(){}return t.next=function(t,e){return g(this,void 0,void 0,function(){var n,o,i,c,s,l,f,p,d;return b(this,function(h){switch(h.label){case 0:return n=a.get(e),o=n.realmPath,i=n.serverConfig,c=n.tree,s=n.type,l=e?e.query:{},f=this.constructUrl(i,o,c,l),p=y({url:new URL(f),init:this.configureRequest(t)},t?r.Authenticate:r.StartAuthenticate,{tree:c,type:s||"service"}),[4,u(fetch(p.url.toString(),p.init),i.timeout)];case 1:return d=h.sent(),[4,this.getResponseJson(d)];case 2:return[2,h.sent()]}})})},t.constructUrl=function(t,e,n,r){var o=n?{authIndexType:"service",authIndexValue:n}:void 0,i=v(v({},r),o),a=Object.keys(i).length>0?"?"+p(i):"",u=l("authenticate",e,t.paths);return f(t.baseUrl,""+u+a)},t.configureRequest=function(t){return{body:t?JSON.stringify(t):void 0,credentials:"include",headers:{accept:"application/json","accept-api-version":"protocol=1.0,resource=2.1","content-type":"application/json","x-requested-with":"forgerock-sdk"},method:"POST"}},t.getResponseJson=function(t){return g(this,void 0,void 0,function(){var e,n,r;return b(this,function(o){switch(o.label){case 0:return e=t.headers.get("content-type"),e&&e.indexOf("application/json")>-1?[4,t.json()]:[3,2];case 1:return r=o.sent(),[3,3];case 2:r={},o.label=3;case 3:return(n=r).status=t.status,n.ok=t.ok,[2,n]}})})},t}();!function(t){t.BadRequest="BAD_REQUEST",t.Timeout="TIMEOUT",t.Unauthorized="UNAUTHORIZED",t.Unknown="UNKNOWN"}(d||(d={})),function(t){t.BooleanAttributeInputCallback="BooleanAttributeInputCallback",t.ChoiceCallback="ChoiceCallback",t.ConfirmationCallback="ConfirmationCallback",t.DeviceProfileCallback="DeviceProfileCallback",t.HiddenValueCallback="HiddenValueCallback",t.KbaCreateCallback="KbaCreateCallback",t.MetadataCallback="MetadataCallback",t.NameCallback="NameCallback",t.NumberAttributeInputCallback="NumberAttributeInputCallback",t.PasswordCallback="PasswordCallback",t.PollingWaitCallback="PollingWaitCallback",t.ReCaptchaCallback="ReCaptchaCallback",t.StringAttributeInputCallback="StringAttributeInputCallback",t.SuspendedTextOutputCallback="SuspendedTextOutputCallback",t.TermsAndConditionsCallback="TermsAndConditionsCallback",t.TextOutputCallback="TextOutputCallback",t.ValidatedCreatePasswordCallback="ValidatedCreatePasswordCallback",t.ValidatedCreateUsernameCallback="ValidatedCreateUsernameCallback"}(h||(h={}));var m,O,C=function(){function t(){this.callbacks={}}return t.prototype.addEventListener=function(t,e){!function(t,e,n){t[e]=t[e]||[],t[e].indexOf(n)<0&&t[e].push(n)}(this.callbacks,t,e)},t.prototype.removeEventListener=function(t,e){!function(t,e,n){if(t[e]){var r=t[e].indexOf(n);r>=0&&t[e].splice(r,1)}}(this.callbacks,t,e)},t.prototype.clearEventListeners=function(t){!function(t,e){Object.keys(t).forEach(function(n){e&&n!==e||delete t[n]})}(this.callbacks,t)},t.prototype.dispatchEvent=function(t){if(this.callbacks[t.type])for(var e=0,n=this.callbacks[t.type];e<n.length;e++){(0,n[e])(t)}},t}();function k(t,e,n){return 1===t?e:void 0!==n?n:e+"s"}function A(t,e,n){return t&&void 0!==t[e]?t[e]:n}!function(t){t.CannotContainCharacters="CANNOT_CONTAIN_CHARACTERS",t.CannotContainDuplicates="CANNOT_CONTAIN_DUPLICATES",t.CannotContainOthers="CANNOT_CONTAIN_OTHERS",t.LeastCapitalLetters="AT_LEAST_X_CAPITAL_LETTERS",t.LeastNumbers="AT_LEAST_X_NUMBERS",t.MatchRegexp="MATCH_REGEXP",t.MaximumLength="MAX_LENGTH",t.MaximumNumber="MAXIMUM_NUMBER_VALUE",t.MinimumLength="MIN_LENGTH",t.MinimumNumber="MINIMUM_NUMBER_VALUE",t.Required="REQUIRED",t.Unique="UNIQUE",t.UnknownPolicy="UNKNOWN_POLICY",t.ValidArrayItems="VALID_ARRAY_ITEMS",t.ValidDate="VALID_DATE",t.ValidEmailAddress="VALID_EMAIL_ADDRESS_FORMAT",t.ValidNameFormat="VALID_NAME_FORMAT",t.ValidNumber="VALID_NUMBER",t.ValidPhoneFormat="VALID_PHONE_FORMAT",t.ValidQueryFilter="VALID_QUERY_FILTER",t.ValidType="VALID_TYPE"}(m||(m={}));var _,T=((O={})[m.CannotContainCharacters]=function(t,e){return t+' must not contain following characters: "'+A(e,"forbiddenChars","")+'"'},O[m.CannotContainDuplicates]=function(t,e){return t+'  must not contain duplicates: "'+A(e,"duplicateValue","")+'"'},O[m.CannotContainOthers]=function(t,e){return t+' must not contain: "'+A(e,"disallowedFields","")+'"'},O[m.LeastCapitalLetters]=function(t,e){var n=A(e,"numCaps",0);return t+" must contain at least "+n+" capital "+k(n,"letter")},O[m.LeastNumbers]=function(t,e){var n=A(e,"numNums",0);return t+" must contain at least "+n+" numeric "+k(n,"value")},O[m.MatchRegexp]=function(t){return t+' has failed the "MATCH_REGEXP" policy'},O[m.MaximumLength]=function(t,e){var n=A(e,"maxLength",0);return t+" must be at most "+n+" "+k(n,"character")},O[m.MaximumNumber]=function(t){return t+' has failed the "MAXIMUM_NUMBER_VALUE" policy'},O[m.MinimumLength]=function(t,e){var n=A(e,"minLength",0);return t+" must be at least "+n+" "+k(n,"character")},O[m.MinimumNumber]=function(t){return t+' has failed the "MINIMUM_NUMBER_VALUE" policy'},O[m.Required]=function(t){return t+" is required"},O[m.Unique]=function(t){return t+" must be unique"},O[m.UnknownPolicy]=function(t,e){return t+': Unknown policy requirement "'+A(e,"policyRequirement","Unknown")+'"'},O[m.ValidArrayItems]=function(t){return t+' has failed the "VALID_ARRAY_ITEMS" policy'},O[m.ValidDate]=function(t){return t+" has an invalid date"},O[m.ValidEmailAddress]=function(t){return t+" has an invalid email address"},O[m.ValidNameFormat]=function(t){return t+" has an invalid name format"},O[m.ValidNumber]=function(t){return t+" has an invalid number"},O[m.ValidPhoneFormat]=function(t){return t+" has an invalid phone number"},O[m.ValidQueryFilter]=function(t){return t+' has failed the "VALID_QUERY_FILTER" policy'},O[m.ValidType]=function(t){return t+' has failed the "VALID_TYPE" policy'},O),P=function(){return(P=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},S=function(){function t(){}return t.parseErrors=function(t,e){var n=this,r=[];return t.detail&&t.detail.failedPolicyRequirements&&t.detail.failedPolicyRequirements.map(function(t){r.push.apply(r,[{detail:t,messages:n.parseFailedPolicyRequirement(t,e)}])}),r},t.parseFailedPolicyRequirement=function(t,e){var n=this,r=[];return t.policyRequirements.map(function(o){r.push(n.parsePolicyRequirement(t.property,o,e))}),r},t.parsePolicyRequirement=function(t,e,n){void 0===n&&(n={});var r="string"==typeof e?JSON.parse(e):P({},e),o=r.policyRequirement;return(n[o]||T[o]||T[m.UnknownPolicy])(t,r.params?P(P({},r.params),{policyRequirement:o}):{policyRequirement:o})},t}();!function(t){t.LoginFailure="LoginFailure",t.LoginSuccess="LoginSuccess",t.Step="Step"}(_||(_={}));var x,N=function(){function t(t){this.payload=t,this.type=_.LoginFailure}return t.prototype.getCode=function(){return Number(this.payload.code)},t.prototype.getDetail=function(){return this.payload.detail},t.prototype.getMessage=function(){return this.payload.message},t.prototype.getProcessedMessage=function(t){return S.parseErrors(this.payload,t)},t.prototype.getReason=function(){return this.payload.reason},t}(),E=function(){function t(t){this.payload=t,this.type=_.LoginSuccess}return t.prototype.getRealm=function(){return this.payload.realm},t.prototype.getSessionToken=function(){return this.payload.tokenId},t.prototype.getSuccessUrl=function(){return this.payload.successUrl},t}(),I=function(){function t(t){this.payload=t}return t.prototype.getType=function(){return this.payload.type},t.prototype.getInputValue=function(t){return void 0===t&&(t=0),this.getArrayElement(this.payload.input,t).value},t.prototype.setInputValue=function(t,e){void 0===e&&(e=0),this.getArrayElement(this.payload.input,e).value=t},t.prototype.getOutputValue=function(t){return void 0===t&&(t=0),this.getArrayElement(this.payload.output,t).value},t.prototype.getOutputByName=function(t,e){var n=this.payload.output.find(function(e){return e.name===t});return n?n.value:e},t.prototype.getArrayElement=function(t,e){if(void 0===e&&(e=0),void 0===t)throw new Error("No NameValue array was provided to search (selector "+e+")");if("number"==typeof e){if(e<0||e>t.length-1)throw new Error("Selector index "+e+" is out of range");return t[e]}if("string"==typeof e){if(!(n=t.find(function(t){return t.name===e})))throw new Error('Missing callback input entry "'+e+'"');return n}if("object"==typeof e&&e.test&&e.exec){var n;if(!(n=t.find(function(t){return e.test(t.name)})))throw new Error('Missing callback input entry "'+e+'"');return n}throw new Error("Invalid selector value type")},t}(),R=(x=function(t,e){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}x(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),V=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return R(e,t),e.prototype.getName=function(){return this.getOutputByName("name","")},e.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},e.prototype.isRequired=function(){return this.getOutputByName("required",!1)},e.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},e.prototype.getPolicies=function(){return this.getOutputByName("policies",{})},e.prototype.setValidateOnly=function(t){this.setInputValue(t,/validateOnly/)},e.prototype.setValue=function(t){this.setInputValue(t)},e}(I),j=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),U=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return j(e,t),e.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},e.prototype.getDefaultChoice=function(){return this.getOutputByName("defaultChoice",0)},e.prototype.getChoices=function(){return this.getOutputByName("choices",[])},e.prototype.setChoiceIndex=function(t){var e=this.getChoices().length;if(t<0||t>e-1)throw new Error(t+" is out of bounds");this.setInputValue(t)},e.prototype.setChoiceValue=function(t){var e=this.getChoices().indexOf(t);if(-1===e)throw new Error('"'+t+'" is not a valid choice');this.setInputValue(e)},e}(I),B=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),M=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return B(e,t),e.prototype.getDefaultOption=function(){return Number(this.getOutputByName("defaultOption",0))},e.prototype.getMessageType=function(){return Number(this.getOutputByName("messageType",0))},e.prototype.getOptions=function(){return this.getOutputByName("options",[])},e.prototype.getOptionType=function(){return Number(this.getOutputByName("optionType",0))},e.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},e.prototype.setOptionIndex=function(t){if(0!==t&&1!==t)throw new Error('"'+t+'" is not a valid choice');this.setInputValue(t)},e.prototype.setOptionValue=function(t){var e=this.getOptions().indexOf(t);if(-1===e)throw new Error('"'+t+'" is not a valid choice');this.setInputValue(e)},e}(I),L=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),D=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return L(e,t),e.prototype.getMessage=function(){return this.getOutputByName("message","")},e.prototype.isMetadataRequired=function(){return this.getOutputByName("metadata",!1)},e.prototype.isLocationRequired=function(){return this.getOutputByName("location",!1)},e.prototype.setProfile=function(t){this.setInputValue(JSON.stringify(t))},e}(I),q=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),F=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return q(e,t),e}(I),z=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),K=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return z(e,t),e.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},e.prototype.getPredefinedQuestions=function(){return this.getOutputByName("predefinedQuestions",[])},e.prototype.setQuestion=function(t){this.setValue("question",t)},e.prototype.setAnswer=function(t){this.setValue("answer",t)},e.prototype.setValue=function(t,e){if(!this.payload.input)throw new Error("KBA payload is missing input");var n=this.payload.input.find(function(e){return e.name.endsWith(t)});if(!n)throw new Error('No input has name ending in "'+t+'"');n.value=e},e}(I),H=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),G=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return H(e,t),e.prototype.getData=function(){return this.getOutputByName("data",{})},e}(I),J=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),W=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return J(e,t),e.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},e.prototype.setName=function(t){this.setInputValue(t)},e}(I),Q=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),X=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return Q(e,t),e.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},e.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},e.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},e.prototype.setPassword=function(t){this.setInputValue(t)},e}(I),Y=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Z=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return Y(e,t),e.prototype.getMessage=function(){return this.getOutputByName("message","")},e.prototype.getWaitTime=function(){return Number(this.getOutputByName("waitTime",0))},e}(I),$=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),tt=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return $(e,t),e.prototype.getSiteKey=function(){return this.getOutputByName("recaptchaSiteKey","")},e.prototype.setResult=function(t){this.setInputValue(t)},e}(I),et=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),nt=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return et(e,t),e.prototype.getMessage=function(){return this.getOutputByName("message","")},e.prototype.getMessageType=function(){return this.getOutputByName("messageType","")},e}(I),rt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ot=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return rt(e,t),e}(nt),it=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),at=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return it(e,t),e.prototype.getTerms=function(){return this.getOutputByName("terms","")},e.prototype.getVersion=function(){return this.getOutputByName("version","")},e.prototype.getCreateDate=function(){var t=this.getOutputByName("createDate","");return new Date(t)},e.prototype.setAccepted=function(t){void 0===t&&(t=!0),this.setInputValue(t)},e}(I),ut=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ct=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return ut(e,t),e.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},e.prototype.getPolicies=function(){return this.getOutputByName("policies",{})},e.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},e.prototype.isRequired=function(){return this.getOutputByName("required",!1)},e.prototype.setPassword=function(t){this.setInputValue(t)},e.prototype.setValidateOnly=function(t){this.setInputValue(t,/validateOnly/)},e}(I),st=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),lt=function(t){function e(e){var n=t.call(this,e)||this;return n.payload=e,n}return st(e,t),e.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},e.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},e.prototype.getPolicies=function(){return this.getOutputByName("policies",{})},e.prototype.isRequired=function(){return this.getOutputByName("required",!1)},e.prototype.setName=function(t){this.setInputValue(t)},e.prototype.setValidateOnly=function(t){this.setInputValue(t,/validateOnly/)},e}(I);var ft=function(t){switch(t.type){case h.BooleanAttributeInputCallback:return new V(t);case h.ChoiceCallback:return new U(t);case h.ConfirmationCallback:return new M(t);case h.DeviceProfileCallback:return new D(t);case h.HiddenValueCallback:return new F(t);case h.KbaCreateCallback:return new K(t);case h.MetadataCallback:return new G(t);case h.NameCallback:return new W(t);case h.NumberAttributeInputCallback:return new V(t);case h.PasswordCallback:return new X(t);case h.PollingWaitCallback:return new Z(t);case h.ReCaptchaCallback:return new tt(t);case h.StringAttributeInputCallback:return new V(t);case h.SuspendedTextOutputCallback:return new ot(t);case h.TermsAndConditionsCallback:return new at(t);case h.TextOutputCallback:return new nt(t);case h.ValidatedCreatePasswordCallback:return new ct(t);case h.ValidatedCreateUsernameCallback:return new lt(t);default:return new I(t)}},pt=function(){function t(t,e){this.payload=t,this.type=_.Step,this.callbacks=[],t.callbacks&&(this.callbacks=this.convertCallbacks(t.callbacks,e))}return t.prototype.getCallbackOfType=function(t){var e=this.getCallbacksOfType(t);if(1!==e.length)throw new Error('Expected 1 callback of type "'+t+'", but found '+e.length);return e[0]},t.prototype.getCallbacksOfType=function(t){return this.callbacks.filter(function(e){return e.getType()===t})},t.prototype.setCallbackValue=function(t,e){var n=this.getCallbacksOfType(t);if(1!==n.length)throw new Error('Expected 1 callback of type "'+t+'", but found '+n.length);n[0].setInputValue(e)},t.prototype.getDescription=function(){return this.payload.description},t.prototype.getHeader=function(){return this.payload.header},t.prototype.getStage=function(){return this.payload.stage},t.prototype.convertCallbacks=function(t,e){return t.map(function(t){return(e||ft)(t)||ft(t)})},t}(),dt=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}c((r=r.apply(t,e||[])).next())})},ht=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},yt=function(){function t(){}return t.next=function(t,e){return dt(this,void 0,void 0,function(){var n,r;return ht(this,function(o){switch(o.label){case 0:return[4,w.next(t?t.payload:void 0,e)];case 1:return(n=o.sent()).authId?(r=e?e.callbackFactory:void 0,[2,new pt(n,r)]):!n.authId&&n.ok?[2,new E(n)]:[2,new N(n)]}})})},t}(),vt=["userAgent","appName","appCodeName","appVersion","appMinorVersion","buildID","product","productSub","vendor","vendorSub","browserLanguage"],gt=["fontNames","displayProps","browserProps","hardwareProps","platformProps"],bt={mac:["Macintosh","MacIntel","MacPPC","Mac68K"],windows:["Win32","Win64","Windows","WinCE"],ios:["iPhone","iPad","iPod"]},wt=["width","height","pixelDepth","orientation.angle"],mt=["cursive","monospace","serif","sans-serif","fantasy","Arial","Arial Black","Arial Narrow","Arial Rounded MT Bold","Bookman Old Style","Bradley Hand ITC","Century","Century Gothic","Comic Sans MS","Courier","Courier New","Georgia","Gentium","Impact","King","Lucida Console","Lalit","Modena","Monotype Corsiva","Papyrus","Tahoma","TeX","Times","Times New Roman","Trebuchet MS","Verdana","Verona"],Ot=["cpuClass","deviceMemory","hardwareConcurrency","maxTouchPoints","oscpu"],Ct=["language","platform","userLanguage","systemLanguage"],kt=function(){function t(){}return t.prototype.reduceToObject=function(t,e){return t.reduce(function(t,n){if(n.includes(".")){var r=n.split("."),o=r[0],i=r[1],a=e[o]&&e[o][i];t[i]=null!=a?a:""}else t[n]=null!=e[n]?e[n]:null;return t},{})},t.prototype.reduceToString=function(t,e){return t.reduce(function(t,n){return t=""+t+e[n].filename+";"},"")},t}(),At=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_t=function(){return(_t=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Tt=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}c((r=r.apply(t,e||[])).next())})},Pt=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},St=function(t){function e(e){var n=t.call(this)||this;return n.config={fontNames:mt,devicePlatforms:bt,displayProps:wt,browserProps:vt,hardwareProps:Ot,platformProps:Ct},e&&Object.keys(e).forEach(function(t){if(!gt.includes(t))throw new Error("Device profile configuration category does not exist.");n.config[t]=e[t]}),n}return At(e,t),e.prototype.getBrowserMeta=function(){return navigator?this.reduceToObject(this.config.browserProps,navigator):(console.warn("Cannot collect browser metadata. navigator is not defined."),{})},e.prototype.getBrowserPluginsNames=function(){return navigator&&navigator.plugins?this.reduceToString(Object.keys(navigator.plugins),navigator.plugins):(console.warn("Cannot collect browser plugin information. navigator.plugins is not defined."),"")},e.prototype.getDeviceName=function(){if(!navigator)return console.warn("Cannot collect device name. navigator is not defined."),"";var t=navigator.userAgent,e=navigator.platform;switch(!0){case this.config.devicePlatforms.mac.includes(e):return"Mac (Browser)";case this.config.devicePlatforms.ios.includes(e):return e+" (Browser)";case this.config.devicePlatforms.windows.includes(e):return"Windows (Browser)";case/Android/.test(e)||/Android/.test(t):return"Android (Browser)";case/CrOS/.test(t)||/Chromebook/.test(t):return"Chrome OS (Browser)";case/Linux/.test(e):return"Linux (Browser)";default:return(e||"Unknown")+" (Browser)"}},e.prototype.getDisplayMeta=function(){return screen||console.warn("Cannot collect screen information. screen is not defined."),this.reduceToObject(this.config.displayProps,screen)},e.prototype.getHardwareMeta=function(){return navigator?this.reduceToObject(this.config.hardwareProps,navigator):(console.warn("Cannot collect OS metadata. Navigator is not defined."),{})},e.prototype.getIdentifier=function(){if(!window.crypto||!window.crypto.getRandomValues)return console.warn("Cannot generate profile ID. Crypto and/or getRandomValues is not supported."),"";if(!localStorage)return console.warn("Cannot store profile ID. localStorage is not supported."),"";var t=localStorage.getItem("profile-id");return t||(t=window.crypto.getRandomValues(new Uint32Array(3)).join("-"),localStorage.setItem("profile-id",t)),t},e.prototype.getInstalledFonts=function(){var t=document.createElement("canvas");if(!t)return console.warn("Cannot collect font data. Browser does not support canvas element"),"";var e=t.getContext&&t.getContext("2d");if(!e)return console.warn("Cannot collect font data. Browser does not support 2d canvas context"),"";var n="abcdefghi0123456789";e.font="72px Comic Sans";var r=e.measureText(n).width;return this.config.fontNames.reduce(function(t,o){return e.font="72px "+o+", Comic Sans",e.measureText(n).width!==r&&(t=""+t+o+";"),t},"")},e.prototype.getLocationCoordinates=function(){return Tt(this,void 0,void 0,function(){var t=this;return Pt(this,function(e){return navigator&&navigator.geolocation?[2,new Promise(function(e){return Tt(t,void 0,void 0,function(){return Pt(this,function(t){return navigator.geolocation.getCurrentPosition(function(t){return e({latitude:t.coords.latitude,longitude:t.coords.longitude})},function(t){console.warn("Cannot collect geolocation information. "+t.code+": "+t.message),e({})},{enableHighAccuracy:!0,timeout:3e4,maximumAge:0}),[2]})})})]:(console.warn("Cannot collect geolocation information. navigator.geolocation is not defined."),[2,Promise.resolve({})])})})},e.prototype.getOSMeta=function(){return navigator?this.reduceToObject(this.config.platformProps,navigator):(console.warn("Cannot collect OS metadata. navigator is not defined."),{})},e.prototype.getProfile=function(t){var e=t.location,n=t.metadata;return Tt(this,void 0,void 0,function(){var t,r;return Pt(this,function(o){switch(o.label){case 0:return t={identifier:this.getIdentifier()},n&&(t.metadata={hardware:_t(_t({},this.getHardwareMeta()),{display:this.getDisplayMeta()}),browser:_t(_t({},this.getBrowserMeta()),{plugins:this.getBrowserPluginsNames()}),platform:_t(_t({},this.getOSMeta()),{deviceName:this.getDeviceName(),fonts:this.getInstalledFonts(),timezone:this.getTimezoneOffset()})}),e?(r=t,[4,this.getLocationCoordinates()]):[3,2];case 1:r.location=o.sent(),o.label=2;case 2:return[2,t]}})})},e.prototype.getTimezoneOffset=function(){try{return(new Date).getTimezoneOffset()}catch(t){return console.warn("Cannot collect timezone information. getTimezoneOffset is not defined."),null}},e}(kt);!function(){function t(){}t.getCodes=function(t){var e;return function(t){var e=t.match(/\s[\w\W]"([\w]*)\\/g);return Array.isArray(e)&&e.map(function(t){var e=t.match(/"([\w]*)\\/);return Array.isArray(e)?e[1]:""})||[]}((null===(e=this.getDisplayCallback(t))||void 0===e?void 0:e.getOutputByName("message",""))||"")},t.isDisplayStep=function(t){return!!this.getDisplayCallback(t)},t.getDisplayCallback=function(t){return t.getCallbacksOfType(h.TextOutputCallback).find(function(t){var e=t.getOutputByName("message",void 0);return e&&(e.includes("Recovery Codes")||e.includes("recovery codes"))})}}();var xt="forgerock-sdk",Nt=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}c((r=r.apply(t,e||[])).next())})},Et=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},It=function(){function t(){}return t.get=function(t){return Nt(this,void 0,void 0,function(){return Et(this,function(e){return[2,new Promise(function(e,n){var r=function(){return n()},o=window.indexedDB.open(xt);o.onsuccess=function(){if(!o.result.objectStoreNames.contains(t))return o.result.close(),n("Client ID not found");var i=o.result.transaction(t,"readonly").objectStore(t).get("tokens");i.onsuccess=function(t){if(!t||!t.target)throw new Error("Missing storage event target");o.result.close(),e(t.target.result)},i.onerror=r},o.onupgradeneeded=function(){o.result.close(),n("IndexedDB upgrade needed")},o.onerror=r})]})})},t.set=function(t,e){return Nt(this,void 0,void 0,function(){return Et(this,function(n){return[2,new Promise(function(n,r){var o=window.indexedDB.open(xt),i=function(){o.result.close(),n()},a=function(){return r()},u=function(){o.result.createObjectStore(t)},c=function(){if(!o.result.objectStoreNames.contains(t)){var n=o.result.version+1;return o.result.close(),(o=window.indexedDB.open(xt,n)).onupgradeneeded=u,o.onsuccess=c,void(o.onerror=a)}var r=o.result.transaction(t,"readwrite");r.onerror=a;var s=r.objectStore(t).put(e,"tokens");s.onsuccess=i,s.onerror=a};o.onupgradeneeded=u,o.onsuccess=c,o.onerror=a})]})})},t.remove=function(t){return Nt(this,void 0,void 0,function(){return Et(this,function(e){return[2,new Promise(function(e,n){var r=function(){return n()},o=window.indexedDB.open(xt);o.onsuccess=function(){if(!o.result.objectStoreNames.contains(t))return e();var n=o.result.transaction(t,"readwrite").objectStore(t).delete("tokens");n.onsuccess=function(){e()},n.onerror=r},o.onerror=r})]})})},t}(),Rt=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}c((r=r.apply(t,e||[])).next())})},Vt=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},jt=function(){function t(){}return t.get=function(t){return Rt(this,void 0,void 0,function(){var e;return Vt(this,function(n){e=localStorage.getItem(xt+"-"+t);try{return[2,Promise.resolve(JSON.parse(e||""))]}catch(t){return console.warn("Could not parse token from localStorage. This could be due to accessing a removed token"),[2,void 0]}return[2]})})},t.set=function(t,e){return Rt(this,void 0,void 0,function(){var n;return Vt(this,function(r){return n=JSON.stringify(e),localStorage.setItem(xt+"-"+t,n),[2]})})},t.remove=function(t){return Rt(this,void 0,void 0,function(){return Vt(this,function(e){return localStorage.removeItem(xt+"-"+t),[2]})})},t}(),Ut=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}c((r=r.apply(t,e||[])).next())})},Bt=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Mt=function(){function t(){}return t.get=function(t){return Ut(this,void 0,void 0,function(){var e;return Bt(this,function(n){e=sessionStorage.getItem(xt+"-"+t);try{return[2,Promise.resolve(JSON.parse(e||""))]}catch(t){return console.warn("Could not parse token from sessionStorage. This could be due to accessing a removed token"),[2,void 0]}return[2]})})},t.set=function(t,e){return Ut(this,void 0,void 0,function(){var n;return Bt(this,function(r){return n=JSON.stringify(e),sessionStorage.setItem(xt+"-"+t,n),[2]})})},t.remove=function(t){return Ut(this,void 0,void 0,function(){return Bt(this,function(e){return sessionStorage.removeItem(xt+"-"+t),[2]})})},t}(),Lt=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}c((r=r.apply(t,e||[])).next())})},Dt=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},qt=function(){function t(){}return t.get=function(){return Lt(this,void 0,void 0,function(){var t,e,n;return Dt(this,function(r){switch(r.label){case 0:return t=this.getClientConfig(),e=t.clientId,"sessionStorage"!==(n=t.tokenStore)?[3,2]:[4,Mt.get(e)];case 1:return[2,r.sent()];case 2:return"localStorage"!==n?[3,4]:[4,jt.get(e)];case 3:return[2,r.sent()];case 4:return"indexedDB"!==n?[3,6]:[4,It.get(e)];case 5:return[2,r.sent()];case 6:return n&&n.get?[4,n.get(e)]:[3,8];case 7:return[2,r.sent()];case 8:return[4,It.get(e)];case 9:return[2,r.sent()]}})})},t.set=function(t){return Lt(this,void 0,void 0,function(){var e,n,r;return Dt(this,function(o){switch(o.label){case 0:return e=this.getClientConfig(),n=e.clientId,"sessionStorage"!==(r=e.tokenStore)?[3,2]:[4,Mt.set(n,t)];case 1:return[2,o.sent()];case 2:return"localStorage"!==r?[3,4]:[4,jt.set(n,t)];case 3:return[2,o.sent()];case 4:return"indexedDB"!==r?[3,6]:[4,It.set(n,t)];case 5:return[2,o.sent()];case 6:return r&&r.set?[4,r.set(n,t)]:[3,8];case 7:return[2,o.sent()];case 8:return[4,It.set(n,t)];case 9:return[2,o.sent()]}})})},t.remove=function(){return Lt(this,void 0,void 0,function(){var t,e,n;return Dt(this,function(r){switch(r.label){case 0:return t=this.getClientConfig(),e=t.clientId,"sessionStorage"!==(n=t.tokenStore)?[3,2]:[4,Mt.remove(e)];case 1:return[2,r.sent()];case 2:return"localStorage"!==n?[3,4]:[4,jt.remove(e)];case 3:return[2,r.sent()];case 4:return"indexedDB"!==n?[3,6]:[4,It.remove(e)];case 5:return[2,r.sent()];case 6:return n&&n.remove?[4,n.remove(e)]:[3,8];case 7:return[2,r.sent()];case 8:return[4,It.remove(e)];case 9:return[2,r.sent()]}})})},t.getClientConfig=function(){var t=a.get(),e=t.clientId,n=t.tokenStore;if(!e)throw new Error("clientId is required to manage token storage");return{clientId:e,tokenStore:n}},t}();function Ft(t){return t.ok||4===Math.floor(t.status/100)}var zt,Kt=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}c((r=r.apply(t,e||[])).next())})},Ht=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Gt=function(){function t(){}return t.createState=function(){return this.createRandomString(16)},t.createVerifier=function(t){return t&&console.warn("Deprecation warning: the parameter for `createVerifier` will be removed in v3"),this.createRandomString(t||32)},t.createChallenge=function(t){return Kt(this,void 0,void 0,function(){var e;return Ht(this,function(n){switch(n.label){case 0:return[4,this.sha256(t)];case 1:return e=n.sent(),[2,this.base64UrlEncode(e)]}})})},t.base64UrlEncode=function(t){var e=Array.prototype.slice.call(t);return window.btoa(String.fromCharCode.apply(null,e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},t.sha256=function(t){return Kt(this,void 0,void 0,function(){var e,n;return Ht(this,function(r){switch(r.label){case 0:return e=(new TextEncoder).encode(t),[4,window.crypto.subtle.digest("SHA-256",e)];case 1:return n=r.sent(),[2,new Uint8Array(n)]}})})},t.createRandomString=function(t){void 0===t&&(t=32);var e=new Uint8Array(t);return window.crypto.getRandomValues(e),btoa(e.join("")).replace(/[^a-zA-Z0-9]+/,"")},t}();!function(t){t.Code="code",t.Token="token"}(zt||(zt={}));var Jt,Wt,Qt=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}c((r=r.apply(t,e||[])).next())})},Xt=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Yt="Authentication or consent required",Zt="Authorization timed out",$t="Failed to fetch",te="NetworkError when attempting to fetch resource.",ee="Cross-origin redirection",ne=function(){function t(){}return t.createAuthorizeUrl=function(t){return Qt(this,void 0,void 0,function(){var e,n,o,i,u,c;return Xt(this,function(s){switch(s.label){case 0:return e=a.get(t),n=e.clientId,o=e.redirectUri,i=e.scope,u={client_id:n,redirect_uri:o,response_type:t.responseType,scope:i,state:t.state},t.verifier?[4,Gt.createChallenge(t.verifier)]:[3,2];case 1:c=s.sent(),u.code_challenge=c,u.code_challenge_method="S256",s.label=2;case 2:return[2,y({url:new URL(this.getUrl("authorize",u,t)),init:{}},r.Authorize).url.toString()]}})})},t.getAuthorizeUrl=function(t){return Qt(this,void 0,void 0,function(){var e,n,r=this;return Xt(this,function(o){switch(o.label){case 0:return console.warn("Deprecation warning: this `getAuthorizeUrl` method will be renamed in v3."),[4,this.createAuthorizeUrl(t)];case 1:return e=o.sent(),n=a.get(t).serverConfig,[2,new Promise(function(t,o){var i,a=document.createElement("iframe"),u=function(){},c=u,s=0;i=function(){window.clearTimeout(s),a.removeEventListener("load",c),a.remove()},c=function(){if(a.contentWindow){var e=a.contentWindow.location.href;r.containsAuthCode(e)?(i(),t(e)):r.containsAuthError(e)&&(i(),t(e))}},s=window.setTimeout(function(){i(),o(new Error(Zt))},n.timeout),a.style.display="none",a.addEventListener("load",c),document.body.appendChild(a),a.src=e})]}})})},t.getOAuth2Tokens=function(t){return Qt(this,void 0,void 0,function(){var e,n,r,o,i,u,c,s,l,f;return Xt(this,function(d){switch(d.label){case 0:return e=a.get(t),n=e.clientId,r=e.redirectUri,o={client_id:n,code:t.authorizationCode,grant_type:"authorization_code",redirect_uri:r},t.verifier&&(o.code_verifier=t.verifier),i=p(o),u={body:i,headers:{"content-length":i.length.toString(),"content-type":"application/x-www-form-urlencoded"},method:"POST"},[4,this.request("accessToken",void 0,!1,u,t)];case 1:return c=d.sent(),[4,this.getBody(c)];case 2:if(s=d.sent(),200!==c.status)throw l="string"==typeof s?"Expected 200, received "+c.status:this.parseError(s),new Error(l);if(!(f=s).access_token)throw new Error("Access token not found in response");return[2,{accessToken:f.access_token,idToken:f.id_token,refreshToken:f.refresh_token}]}})})},t.getUserInfo=function(t){return Qt(this,void 0,void 0,function(){var e;return Xt(this,function(n){switch(n.label){case 0:return[4,this.request("userInfo",void 0,!0,void 0,t)];case 1:if(200!==(e=n.sent()).status)throw new Error("Failed to get user info; received "+e.status);return[4,e.json()];case 2:return[2,n.sent()]}})})},t.endSession=function(t){return Qt(this,void 0,void 0,function(){var e,n,r;return Xt(this,function(o){switch(o.label){case 0:return[4,qt.get()];case 1:return e=o.sent().idToken,n={},e&&(n.id_token_hint=e),[4,this.request("endSession",n,!0,void 0,t)];case 2:if(!Ft(r=o.sent()))throw new Error("Failed to end session; received "+r.status);return[2,r]}})})},t.revokeToken=function(t){return Qt(this,void 0,void 0,function(){var e,n,r,o;return Xt(this,function(i){switch(i.label){case 0:return e=a.get(t).clientId,[4,qt.get()];case 1:return n=i.sent().accessToken,r={body:p({client_id:e,token:n}),credentials:"include",headers:{"content-type":"application/x-www-form-urlencoded"},method:"POST"},[4,this.request("revoke",void 0,!1,r,t)];case 2:if(!Ft(o=i.sent()))throw new Error("Failed to revoke token; received "+o.status);return[2,o]}})})},t.request=function(t,e,n,o,i){return Qt(this,void 0,void 0,function(){var c,s,l,f,p;return Xt(this,function(d){switch(d.label){case 0:return c=a.get(i).serverConfig,s=this.getUrl(t,e,i),l=function(t){switch(t){case"accessToken":return r.ExchangeToken;case"endSession":return r.Logout;case"revoke":return r.RevokeToken;default:return r.UserInfo}},o=o||{},n?[4,qt.get()]:[3,2];case 1:f=d.sent().accessToken,o.credentials="include",o.headers=o.headers||new Headers,o.headers.set("authorization","Bearer "+f),d.label=2;case 2:return p=y({url:new URL(s),init:o},l(t)),[4,u(fetch(p.url.toString(),p.init),c.timeout)];case 3:return[2,d.sent()]}})})},t.containsAuthCode=function(t){return!!t&&/code=([^&]+)/.test(t)},t.containsAuthError=function(t){return!!t&&/error=([^&]+)/.test(t)},t.getBody=function(t){return Qt(this,void 0,void 0,function(){var e;return Xt(this,function(n){switch(n.label){case 0:return(e=t.headers.get("content-type"))&&e.indexOf("application/json")>-1?[4,t.json()]:[3,2];case 1:return[2,n.sent()];case 2:return[4,t.text()];case 3:return[2,n.sent()]}})})},t.parseError=function(t){if(t){if(t.error&&t.error_description)return t.error+": "+t.error_description;if(t.code&&t.message)return t.code+": "+t.message}},t.getUrl=function(t,e,n){var r=a.get(n),o=r.realmPath,i=r.serverConfig,u=l(t,o,i.paths),c=f(i.baseUrl,u);return e&&(c+="?"+p(e)),c},t}(),re=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}c((r=r.apply(t,e||[])).next())})},oe=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ie=function(){function t(){}return t.logout=function(t){return re(this,void 0,void 0,function(){var e,n,o,i,c,s,p,d;return oe(this,function(h){switch(h.label){case 0:return e=a.get(t),n=e.realmPath,o=e.serverConfig,i={credentials:"include",headers:{"accept-api-version":"protocol=1.0,resource=2.0","x-requested-with":"forgerock-sdk"},method:"POST"},c=l("sessions",n,o.paths)+"?_action=logout",s=f(o.baseUrl,c),p=y({url:new URL(s),init:i},r.Logout),[4,u(fetch(p.url.toString(),p.init),o.timeout)];case 1:if(!Ft(d=h.sent()))throw new Error("Failed to log out; received "+d.status);return[2,d]}})})},t}(),ae=function(){return(ae=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ue=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}c((r=r.apply(t,e||[])).next())})},ce=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},se=function(){function t(){}return t.getTokens=function(e){var n,r,o;return ue(this,void 0,void 0,function(){var i,c,s,l,f,p,d,h,y,v,g,b,w,m,O,C,k,A;return ce(this,function(_){switch(_.label){case 0:i=null,c=a.get(e),s=c.clientId,l=c.serverConfig,f=c.support,_.label=1;case 1:return _.trys.push([1,3,,4]),[4,qt.get()];case 2:return i=_.sent(),[3,4];case 3:return p=_.sent(),console.info("No stored tokens available",p),[3,4];case 4:if(i&&!(null==e?void 0:e.forceRenew)&&!(null===(n=null==e?void 0:e.query)||void 0===n?void 0:n.code))return[2,i];if(!i)return[3,9];_.label=5;case 5:return _.trys.push([5,8,,9]),[4,ne.revokeToken(e)];case 6:return _.sent(),[4,t.deleteTokens()];case 7:return _.sent(),[3,9];case 8:return d=_.sent(),console.warn("Existing tokens could not be revoked or deleted",d),[3,9];case 9:return(null===(r=null==e?void 0:e.query)||void 0===r?void 0:r.code)&&(null===(o=null==e?void 0:e.query)||void 0===o?void 0:o.state)?(h=window.sessionStorage.getItem(s),window.sessionStorage.removeItem(s),y=JSON.parse(h),[4,this.tokenExchange(e,y)]):[3,11];case 10:return[2,_.sent()];case 11:return v=Gt.createVerifier(),g=Gt.createState(),b=ae(ae({},e),{responseType:zt.Code,state:g,verifier:v}),[4,ne.createAuthorizeUrl(b)];case 12:w=_.sent(),_.label=13;case 13:return _.trys.push([13,18,,19]),m=void 0,"legacy"!==f&&void 0!==f?[3,15]:(O=URL.bind,[4,ne.getAuthorizeUrl(b)]);case 14:return m=new(O.apply(URL,[void 0,_.sent()])),[3,17];case 15:return[4,u(fetch(w,{credentials:"include",mode:"cors"}),l.timeout)];case 16:C=_.sent(),m=new URL(C.url),_.label=17;case 17:if(m.searchParams.get("error"))throw Error(""+m.searchParams.get("error_description"));if(!m.searchParams.get("code"))throw Error(Yt);return T=m.toString(),P=new URL(T),S={},P.searchParams.forEach(function(t,e){return S[e]=t}),k=S,e||(e={}),e.query=k,[3,19];case 18:if(A=_.sent(),"redirect"!==(null==e?void 0:e.login))throw A;if(Yt!==A.message&&Zt!==A.message&&$t!==A.message&&te!==A.message&&!A.message.includes(ee))throw A;return window.sessionStorage.setItem(s,JSON.stringify(b)),[2,window.location.assign(w)];case 19:return[4,this.tokenExchange(e,{state:g,verifier:v})];case 20:return[2,_.sent()]}var T,P,S})})},t.deleteTokens=function(){return ue(this,void 0,void 0,function(){return ce(this,function(t){switch(t.label){case 0:return[4,qt.remove()];case 1:return t.sent(),[2]}})})},t.tokenExchange=function(t,e){var n,r,o,i;return ue(this,void 0,void 0,function(){var a,u,c,s,l;return ce(this,function(f){switch(f.label){case 0:if((null===(n=t.query)||void 0===n?void 0:n.state)!==e.state)throw new Error("State mismatch");if(!(null===(r=t.query)||void 0===r?void 0:r.code)||Array.isArray(null===(o=t.query)||void 0===o?void 0:o.code))throw new Error("Failed to acquire authorization code");return a=null===(i=t.query)||void 0===i?void 0:i.code,u=e.verifier,c=ae(ae({},t),{authorizationCode:a,verifier:u}),[4,ne.getOAuth2Tokens(c)];case 1:if(!(s=f.sent())||!s.accessToken)throw new Error("Unable to exchange authorization for tokens");f.label=2;case 2:return f.trys.push([2,4,,5]),[4,qt.set(s)];case 3:return f.sent(),[3,5];case 4:return l=f.sent(),console.error("Failed to store tokens",l),[3,5];case 5:return[2,s]}})})},t}(),le=function(){function t(){}return t.getCurrentUser=function(){return ne.getUserInfo()},t}(),fe=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}c((r=r.apply(t,e||[])).next())})},pe=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};!function(){function t(){}t.login=function(t,e){return fe(this,void 0,void 0,function(){return pe(this,function(n){throw console.info(t,e),new Error("FRUser.login() not implemented")})})},t.loginWithUI=function(t,e){return fe(this,void 0,void 0,function(){return pe(this,function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),[4,t.getSession(e)];case 1:return n.sent(),[4,se.getTokens({forceRenew:!0})];case 2:return n.sent(),[4,le.getCurrentUser()];case 3:return[2,n.sent()];case 4:throw n.sent(),new Error("Login failed");case 5:return[2]}})})},t.logout=function(t){return fe(this,void 0,void 0,function(){return pe(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,ie.logout()];case 1:return e.sent(),[3,3];case 2:return e.sent(),console.warn("Session logout was not successful"),[3,3];case 3:return e.trys.push([3,5,,6]),[4,ne.endSession(t)];case 4:return e.sent(),[3,6];case 5:return e.sent(),console.warn("OAuth endSession was not successful"),[3,6];case 6:return e.trys.push([6,8,,9]),[4,ne.revokeToken(t)];case 7:return e.sent(),[3,9];case 8:return e.sent(),console.warn("OAuth revokeToken was not successful"),[3,9];case 9:return[4,se.deleteTokens()];case 10:return e.sent(),[2]}})})}}();function de(t){return t||[]}function he(t){var e=new Uint8Array(t);return(new TextDecoder).decode(e)}function ye(t){return t?t[1]:""}function ve(t){try{return t.split("}").filter(function(t){return!!t&&"]"!==t}).map(function(t){var e=function(t){var e=/new Int8Array\((.+)\)/.exec(t);if(null===e||e.length<2)return[];return JSON.parse(e[1])}(t);return{id:new Int8Array(e).buffer,type:"public-key"}})}catch(t){throw new Error("Failed to parse credentials")}}function ge(t){if(t){if(Array.isArray(t))return t;if("string"==typeof t)return t&&"["===t[0]?JSON.parse(t):(t=t.replace(/(\w+):/g,'"$1":'),JSON.parse("["+t+"]"))}}function be(t){return t.includes("rpId")?t.replace(/rpId: "(.+)",/,"$1"):t.replace(/id: "(.+)",/,"$1")}!function(t){t.Error="ERROR",t.Unsupported="unsupported"}(Jt||(Jt={})),function(t){t[t.None=0]="None",t[t.Authentication=1]="Authentication",t[t.Registration=2]="Registration"}(Wt||(Wt={}));var we=function(){return(we=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};var me=function(){return(me=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Oe=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}c((r=r.apply(t,e||[])).next())})},Ce=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ke=(function(){function t(){}t.getWebAuthnStepType=function(t){var e=this.getOutcomeCallback(t),n=this.getMetadataCallback(t),r=this.getTextOutputCallback(t);if(e&&n){var o=n.getOutputValue("data");return(null==o?void 0:o.pubKeyCredParams)?Wt.Registration:Wt.Authentication}return e&&r?r.getMessage().includes("pubKeyCredParams")?Wt.Registration:Wt.Authentication:Wt.None},t.authenticate=function(t){return Oe(this,void 0,void 0,function(){var e,n,r,o,i,a,u,c,s;return Ce(this,function(l){switch(l.label){case 0:if(e=this.getCallbacks(t),n=e.hiddenCallback,r=e.metadataCallback,o=e.textOutputCallback,!n||!r&&!o)return[3,5];i=void 0,l.label=1;case 1:return l.trys.push([1,3,,4]),a=void 0,r?(u=r.getOutputValue("data"),a=this.createAuthenticationPublicKey(u)):o&&(a=function(t){var e,n;n=t.includes("acceptableCredentials")?ye(t.match(/acceptableCredentials"*\s*=\s*\[([^]+)\s*]/)).trim():ye(t.match(/allowCredentials"{0,}:\s{0,}\[([^]+)\s{0,}]/)).trim();var r=ye(t.match(/userVerification"{0,}:\s{0,}"(\w+)"/));n&&(e=(n.split("},")||[n]).map(function(t){var e=ye(t.match(/type"{0,}:\s{0,}"([\w-]+)"/)),n=de(t.match(/id"{0,}:\s{0,}new\s{0,}(Uint|Int)8Array\(([^\)]+)/)),r=JSON.parse(n[2]);return{type:e,id:new Int8Array(r).buffer}}));var o=Number(ye(t.match(/timeout"{0,}:\s{0,}(\d+)/))),i=de(t.match(/challenge"{0,}:\s{0,}new\s{0,}(Uint|Int)8Array\(([^\)]+)/)),a=JSON.parse(i[2]),u=new Int8Array(a).buffer,c=ye(t.match(/rpId"{0,}:\s{0,}\\{0,}"([^"\\]*)/));return we(we(we({challenge:u,timeout:o},e&&{allowCredentials:e}),r&&{userVerification:r}),c&&{rpId:c})}(o.getMessage())),[4,this.getAuthenticationCredential(a)];case 2:return c=l.sent(),i=this.getAuthenticationOutcome(c),[3,4];case 3:throw s=l.sent(),new Error("WebAuthn: "+s.message);case 4:return n.setInputValue(i),[2,t];case 5:throw new Error("WebAuthn: Invalid payload")}})})},t.register=function(t){return Oe(this,void 0,void 0,function(){var e,n,r,o,i,a,u,c,s;return Ce(this,function(l){switch(l.label){case 0:if(e=this.getCallbacks(t),n=e.hiddenCallback,r=e.metadataCallback,o=e.textOutputCallback,!n||!r&&!o)return[3,5];i=void 0,l.label=1;case 1:return l.trys.push([1,3,,4]),a=void 0,r?(u=r.getOutputValue("data"),a=this.createRegistrationPublicKey(u)):o&&(a=function(t){var e=new TextEncoder,n=ye(t.match(/attestation"{0,}:\s{0,}"(\w+)"/)),r=Number(ye(t.match(/timeout"{0,}:\s{0,}(\d+)/))),o=ye(t.match(/userVerification"{0,}:\s{0,}"(\w+)"/)),i=ye(t.match(/requireResidentKey"{0,}:\s{0,}(\w+)/)),a=ye(t.match(/authenticatorAttachment"{0,}:\s{0,}"([\w-]+)/)),u=ye(t.match(/rp"{0,}:\s{0,}{([^}]+)}/)).trim(),c=ye(u.match(/id"{0,}:\s{0,}"([^"]*)"/)),s=ye(u.match(/name"{0,}:\s{0,}"([^"]*)"/)),l=ye(t.match(/user"{0,}:\s{0,}{([^]{0,})},/)).trim(),f=ye(l.match(/id"{0,}:\s{0,}Uint8Array.from\("([^"]+)"/)),p=ye(l.match(/name"{0,}:\s{0,}"([\d\w._-]+)"/)),d=ye(l.match(/displayName"{0,}:\s{0,}"([\d\w\s.@_-]+)"/)),h=ge(ye(t.match(/pubKeyCredParams"*:\s*\[([^]+\d\s*})\s*]/)).trim());if(!h)throw new Error("Missing pubKeyCredParams");var y=ve(ye(t.match(/excludeCredentials"{0,}:\s{0,}\[([^]+)\s{0,}]/)).trim()),v=de(t.match(/challenge"{0,}:\s{0,}new\s{0,}(Uint|Int)8Array\(([^\)]+)/)),g=JSON.parse(v[2]),b=new Int8Array(g).buffer;return we(we({attestation:n,authenticatorSelection:we(we({userVerification:o},a&&{authenticatorAttachment:a}),"true"===i&&{requireResidentKey:!!i}),challenge:b},y.length&&{excludeCredentials:y}),{pubKeyCredParams:h,rp:we({name:s},c&&{id:c}),timeout:r,user:{displayName:d,id:e.encode(f),name:p}})}(o.getMessage())),[4,this.getRegistrationCredential(a)];case 2:return c=l.sent(),i=this.getRegistrationOutcome(c),[3,4];case 3:throw s=l.sent(),new Error("WebAuthn: "+s.message);case 4:return n.setInputValue(i),[2,t];case 5:throw new Error("WebAuthn: Invalid payload")}})})},t.getCallbacks=function(t){var e=this.getOutcomeCallback(t),n=this.getMetadataCallback(t),r=this.getTextOutputCallback(t),o={hiddenCallback:e};return n?o.metadataCallback=n:r&&(o.textOutputCallback=r),o},t.getMetadataCallback=function(t){return t.getCallbacksOfType(h.MetadataCallback).find(function(t){var e=t.getOutputByName("data",void 0);return e&&e.hasOwnProperty("relyingPartyId")})},t.getOutcomeCallback=function(t){return t.getCallbacksOfType(h.HiddenValueCallback).find(function(t){return"webAuthnOutcome"===t.getOutputByName("id","")})},t.getTextOutputCallback=function(t){return t.getCallbacksOfType(h.TextOutputCallback).find(function(t){var e=t.getOutputByName("message",void 0);return e&&e.includes("webAuthnOutcome")})},t.getAuthenticationCredential=function(t){return Oe(this,void 0,void 0,function(){return Ce(this,function(e){switch(e.label){case 0:return[4,navigator.credentials.get({publicKey:t})];case 1:return[2,e.sent()]}})})},t.getAuthenticationOutcome=function(t){if(!window.PublicKeyCredential)return Jt.Unsupported;try{if(null===t)throw new Error("WebAuthn: No credential provided");var e=he(t.response.clientDataJSON),n=t.response,r=new Int8Array(n.authenticatorData).toString(),o=new Int8Array(n.signature).toString(),i=he(t.response.userHandle),a=e+"::"+r+"::"+o+"::"+t.id;return i&&(a=a+"::"+i),a}catch(t){throw new Error(t.message)}},t.getRegistrationCredential=function(t){return Oe(this,void 0,void 0,function(){return Ce(this,function(e){switch(e.label){case 0:return[4,navigator.credentials.create({publicKey:t})];case 1:return[2,e.sent()]}})})},t.getRegistrationOutcome=function(t){if(!window.PublicKeyCredential)return Jt.Unsupported;try{if(null===t)throw new Error("No credential provided");var e=he(t.response.clientDataJSON),n=t.response;return e+"::"+new Int8Array(n.attestationObject).toString()+"::"+t.id}catch(t){throw new Error(t.message)}},t.createAuthenticationPublicKey=function(t){var e=t.acceptableCredentials,n=t.allowCredentials,r=t.challenge,o=t.relyingPartyId,i=t.timeout,a=t.userVerification,u=be(o),c=ve(n||e||"");return me(me(me({challenge:Uint8Array.from(atob(r),function(t){return t.charCodeAt(0)}).buffer,timeout:i},c&&{allowCredentials:c}),a&&{userVerification:a}),u&&{rpId:u})},t.createRegistrationPublicKey=function(t){var e=ge(t.pubKeyCredParams);if(!e||!e.length)throw new Error("Missing pubKeyCredParams");var n=ve(t.excludeCredentials),r=t.attestationPreference,o=t.authenticatorSelection,i=t.challenge,a=t.relyingPartyId,u=t.relyingPartyName,c=t.timeout,s=t.userId,l=t.userName,f=t.displayName,p=be(a),d=me({name:u},p&&{id:p});return me(me({attestation:r,authenticatorSelection:JSON.parse(o),challenge:Uint8Array.from(atob(i),function(t){return t.charCodeAt(0)}).buffer},n.length&&{excludeCredentials:n}),{pubKeyCredParams:e,rp:d,timeout:c,user:{displayName:f||l,id:Int8Array.from(s.split("").map(function(t){return t.charCodeAt(0)})),name:l}})}}(),function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}c((r=r.apply(t,e||[])).next())})}),Ae=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};function _e(t){return ke(this,void 0,void 0,function(){return Ae(this,function(e){switch(e.label){case 0:return[4,t.clone().json()];case 1:return[2,!!e.sent().advices]}})})}function Te(t){var e=new URL(t).searchParams.get("authIndexValue")||"",n=new DOMParser,r=decodeURIComponent(e),o=n.parseFromString(r,"application/xml").querySelector("Value");return o?o.innerHTML:""}function Pe(t){return ke(this,void 0,void 0,function(){return Ae(this,function(e){switch(e.label){case 0:return[4,t.clone().json()];case 1:return[2,!!e.sent().callbacks]}})})}function Se(t){return ke(this,void 0,void 0,function(){return Ae(this,function(e){switch(e.label){case 0:return[4,t.json()];case 1:return[2,e.sent()]}})})}var xe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ne=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}c((r=r.apply(t,e||[])).next())})},Ee=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}xe(e,t),e.request=function(t){return Ne(this,void 0,void 0,function(){var e,n,o,i,u,c,s,d,h,v,g,b,w,m,O,C;return Ee(this,function(k){switch(k.label){case 0:return[4,this._request(t,!1)];case 1:return e=k.sent(),o=!1,function(t,e){return"function"==typeof e?e(t):401===t.status}(e,t.requiresNewToken)?[4,this._request(t,!0)]:[3,3];case 2:e=k.sent(),k.label=3;case 3:return t.authorization&&t.authorization.handleStep?e.redirected&&function(t){return(t.headers.get("Content-Type")||"").includes("html")&&t.url.includes("composite_advice")}(e)?(o=!0,n=function(t){var e={};return t.url.includes("AuthenticateToServiceConditionAdvice")?e.AuthenticateToServiceConditionAdvice=[Te(t.url)]:e.TransactionConditionAdvice=[Te(t.url)],{resource:"",actions:{},attributes:{},advices:e,ttl:0}}(e),[3,7]):[3,4]:[3,18];case 4:return[4,_e(e)];case 5:return k.sent()?[4,Se(e)]:[3,7];case 6:n=k.sent(),k.label=7;case 7:return n&&n.advices?(i=a.get(t.authorization.config),u=i.realmPath,c=i.serverConfig,s=function(t,e,n,r,o){var i=t.advices&&t.advices.AuthenticateToServiceConditionAdvice,a=t.advices&&t.advices.TransactionConditionAdvice,u="",c="";i?(u=i.reduce(function(t,e){return t=""+e+(t?" "+t:t)},""),c="AuthenticateToServiceConditionAdvice"):a&&(u=a.reduce(function(t,e){return t=""+e+(t?" "+t:t)},""),c="TransactionConditionAdvice");var s='<Advices><AttributeValuePair><Attribute name="'+c+'"/><Value>'+u+"</Value></AttributeValuePair></Advices>";return{init:{method:"POST",credentials:"include",headers:{"Accept-API-Version":"resource=2.0, protocol=1.0"}},timeout:n,url:f(e,l("authenticate",r,o)+"?"+p({authIndexType:"composite_advice",authIndexValue:s}))}}(n,c.baseUrl,t.timeout,u,c.paths),d=new URL(s.url),h=d.searchParams.get("authIndexType"),v=d.searchParams.get("authIndexValue"),g=y({url:new URL(s.url),init:s.init},r.StartAuthenticate,{type:h,tree:v}),b=g.url,w=g.init,s.url=b.toString(),s.init=w,[4,this._request(s,!1)]):[3,18];case 8:return[4,Pe(m=k.sent())];case 9:if(!k.sent())throw new Error('Error: Initial response from auth server not a "step".');if(!((A=n).advices&&A.advices.AuthenticateToServiceConditionAdvice?Array.isArray(A.advices.AuthenticateToServiceConditionAdvice)&&A.advices.AuthenticateToServiceConditionAdvice.length>0:A.advices&&A.advices.TransactionConditionAdvice&&Array.isArray(A.advices.TransactionConditionAdvice)&&A.advices.TransactionConditionAdvice.length>0))throw new Error("Error: Transactional or Service Advice is empty.");k.label=10;case 10:return k.trys.push([10,17,,18]),[4,this.stepIterator(m,t.authorization.handleStep,h,v)];case 11:k.sent(),O=void 0,k.label=12;case 12:return k.trys.push([12,14,,15]),[4,qt.get()];case 13:return O=k.sent(),[3,15];case 14:return k.sent(),[3,15];case 15:return o?t.url=function(t,e,n){var r=new URL(t);if(e.TransactionConditionAdvice){var o=e.TransactionConditionAdvice[0];r.searchParams.append("_txid",o)}return n&&n.idToken&&r.searchParams.append("_idtoken",n.idToken),r.toString()}(t.url,n.advices,O):t.init.headers=function(t,e,n){var r=new Headers(t.headers);return e.AuthenticateToServiceConditionAdvice?r.set("x-tree",e.AuthenticateToServiceConditionAdvice[0]):e.TransactionConditionAdvice&&r.set("x-txid",e.TransactionConditionAdvice[0]),n&&n.idToken&&r.set("x-idtoken",n.idToken),r}(t.init,n.advices,O),[4,this._request(t,!1)];case 16:return e=k.sent(),[3,18];case 17:throw C=k.sent(),new Error(C);case 18:return[2,e]}var A})})},e.setAuthHeaders=function(t,e){return Ne(this,void 0,void 0,function(){var n;return Ee(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,qt.get()];case 1:return n=r.sent(),[3,3];case 2:return r.sent(),[3,3];case 3:return n&&n.accessToken?[4,se.getTokens({forceRenew:e})]:[3,5];case 4:(n=r.sent())&&n.accessToken&&t.set("Authorization","Bearer "+n.accessToken),r.label=5;case 5:return[2,t]}})})},e.stepIterator=function(t,e,n,r){return Ne(this,void 0,void 0,function(){var o,i,a=this;return Ee(this,function(u){switch(u.label){case 0:return[4,t.json()];case 1:return o=u.sent(),i=new pt(o),[2,new Promise(function(t,o){return Ne(a,void 0,void 0,function(){return Ee(this,function(a){return function i(a){return Ne(this,void 0,void 0,function(){var u,c;return Ee(this,function(s){switch(s.label){case 0:return[4,e(a)];case 1:return u=s.sent(),[4,yt.next(u,{type:n,tree:r})];case 2:return(c=s.sent()).type===_.LoginSuccess?t():c.type===_.LoginFailure?o("Authentication tree failure."):i(c),[2]}})})}(i),[2]})})})]}})})},e._request=function(t,e){return Ne(this,void 0,void 0,function(){var n,r,o,i,a;return Ee(this,function(c){switch(c.label){case 0:return n=t.url,r=t.init,o=t.timeout,i=new Headers(r.headers||{}),t.bypassAuthentication?[3,2]:[4,this.setAuthHeaders(i,e)];case 1:i=c.sent(),c.label=2;case 2:r.headers=i,c.label=3;case 3:return c.trys.push([3,5,,7]),[4,u(fetch(n,r),o)];case 4:return a=c.sent(),[3,7];case 5:return c.sent(),[4,u(fetch(n,{method:"GET"}),o)];case 6:return a=c.sent(),[3,7];case 7:return[2,a]}})})}}(C);!function(){function t(t){void 0===t&&(t=!1),this.storage=t?window.localStorage:window.sessionStorage}t.prototype.get=function(t){var e=this.storage.getItem(t);if(e)return JSON.parse(e)},t.prototype.set=function(t,e){this.storage.setItem(t,JSON.stringify(e))},t.prototype.remove=function(t){this.storage.removeItem(t)}}();n.d(e,"a",function(){return St})}}]);
//# sourceMappingURL=8.17c83f4339.js.map