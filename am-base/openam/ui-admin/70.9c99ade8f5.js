(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{1400:function(e,t,n){"use strict";n(50),n(144);var o=n(2),r=n.n(o),a=n(1),i=n.n(a),c=n(41),s=n(88);t.a=function(e){var t=function(t){var n=c.a.currentRoute,o=c.a.extractParameters(n,s.a.getCurrentFragment()),a=c.a.applyDefaultParameters(n,o),u={params:r.a.map(a,function(e){return e?decodeURIComponent(e):""})};return i.a.createElement(e,r.a.extend({},t,{router:u}))};return t.displayName="withRouter(".concat(function(e){return e.displayName||e.name||"Component"}(e),")"),t.WrappedComponent=e,t}},1401:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=r.a.shape({params:r.a.array.isRequired});t.a=a},1402:function(e,t,n){"use strict";n(144),n(81);var o=n(1424),r=n(1),a=n.n(r),i=n(64);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}t.a=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var s=o.a.apply(void 0,n)(e),u=function(e){return a.a.createElement(s,c({},e,{store:i.a}))};return u.displayName="connectWithStore(".concat(function(e){return e.displayName||e.name||"Component"}(e),")"),u.WrappedComponent=e,u}},1407:function(e,t,n){"use strict";var o=n(1),r=n.n(o),a=n(16);t.a=function(){return r.a.createElement("p",{className:"loading text-muted"},r.a.createElement("i",{className:"fa fa-circle-o-notch fa-spin fa-2x fa-fw"}),r.a.createElement("span",null,Object(a.b)("console.common.loading")))}},1481:function(e,t,n){"use strict";n.d(t,"a",function(){return f}),n.d(t,"b",function(){return b}),n.d(t,"c",function(){return h}),n.d(t,"d",function(){return y}),n.d(t,"e",function(){return m}),n.d(t,"f",function(){return g});n(15),n(36),n(37),n(17),n(33),n(50),n(21),n(22),n(18),n(27),n(67),n(62),n(35),n(19),n(34);var o=n(162),r=n(2),a=n(370),i=n(372),c=n(371);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],o=!0,r=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(o=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(e){r=!0,a=e}finally{try{o||null==c.return||c.return()}finally{if(r)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=function(e){return new o.CRESTv2_1(Object(c.a)("/realm-config/authentication/authenticationtrees/trees",e),{middleware:[a.a]})},d=function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(n,!0).forEach(function(t){l(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{nodes:Object(r.mapValues)(e.nodes,function(e){return Object(r.omitBy)(e,function(e,t){return Object(r.startsWith)(t,"_")})})})},f=function(e,t,n){return Object(i.a)(p(e).create(d(t),{id:n}))},b=function(e,t){return Object(i.a)(p(e).get(t,{queryString:{forUI:!0}}))},h=function(e){return p(e).action("getIds")},y=function(e){return Promise.all([p(e).action("schema"),p(e).action("template")]).then(function(e){var t=s(e,2);return{schema:t[0],template:t[1]}})},m=function(e,t){return Promise.all(t.map(function(t){return p(e).delete(t)}))},g=function(e,t,n){return Object(i.a)(p(e).update(n,d(t)))}},1484:function(e,t,n){"use strict";n(15),n(63),n(81),n(18);var o=n(25),r=n(16),a=n(0),i=n.n(a),c=n(1),s=n.n(c);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function l(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=function(e){var t=e.value,n=e.label,r=e.onClear,a=e.isResetEnabled,i=l(e,["value","label","onClear","isResetEnabled"]);return s.a.createElement(o.m,{className:"am-search-field-with-reset",controlId:"searchFieldWithReset"},s.a.createElement(o.i,{srOnly:!0},n),s.a.createElement(o.p,null,s.a.createElement(o.l,u({},i,{value:t})),s.a.createElement("i",{className:"fa fa-search"}),s.a.createElement(o.p.Button,null,s.a.createElement(o.c,{disabled:!a,onClick:r},s.a.createElement("i",{className:"fa fa-times"})))))};p.defaultProps={placeholder:Object(r.b)("common.form.filter"),isResetEnabled:!1},p.propTypes={isResetEnabled:i.a.bool,label:i.a.string.isRequired,onBlur:i.a.func,onChange:i.a.func,onClear:i.a.func.isRequired,onKeyPress:i.a.func,placeholder:i.a.string,value:i.a.string.isRequired},t.a=p},1505:function(e,t,n){"use strict";n(82);var o=n(2),r=n(16);t.a=function(e){return"/"===e?Object(r.b)("console.common.topLevelRealm"):Object(o.last)(e.split("/"))}},1506:function(e,t,n){"use strict";n(31),n(159),n(82);var o=n(2),r=n.n(o),a=n(14),i=n.n(a),c=n(88);t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;!function(e){if(!e)throw new Error('[createBreadcrumbs] No "pattern" found.')}(e);var n=r.a.compact(c.a.getCurrentFragment().split("/")),o=function(e){return r.a.take(e,2).join("/")}(n),a=function(e,t){return r.a.drop(e,t)}(n,t),s=["INSTANCE","ACTION","COLLECTION"],u=a.length-1,l=[],p=function(e,t){return"?"===t?0:1}(0,function(e){return r.a.last(e.split("/"))}(e));return r.a.forEachRight(a,function(e,t){var n=function(e,t){var n=0===t?i.a.t("console.navigation.".concat(e,".breadcrumb")):e;return decodeURIComponent(n)}(e,t),c=function(e,t,n){return"#".concat(n,"/").concat(r.a.take(e,t+1).join("/"))}(a,t,o);t===u?l.unshift({title:n}):"INSTANCE"===s[p]||0===t?l.unshift({title:n,path:c}):"COLLECTION"===s[p]&&l.unshift({title:n}),p=p<s.length-1?p+1:0}),l}},1509:function(e,t,n){"use strict";n(15),n(17),n(63),n(21),n(22),n(18),n(19);var o=n(2);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(n,!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}t.a=function(e){return function e(t){var n=t.format,r=c(t,["format"]);return"password"===n?a({},r,{_isPassword:!0}):r.properties?a({},r,{properties:Object(o.mapValues)(r.properties,function(t){return e(t)})}):a({format:n},r)}(Object(o.cloneDeep)(e))}},1624:function(e){e.exports=JSON.parse('{"basicAuthentication":{"tag":"basic authentication","icon":"user"},"mfa":{"tag":"mfa","icon":"desktop"},"risk":{"tag":"risk","icon":"balance-scale"},"behavioral":{"tag":"behavioral","icon":"puzzle-piece"},"contextual":{"tag":"contextual","icon":"bullseye"},"federation":{"tag":"federation","icon":"building"},"identityManagement":{"tag":"identity management","icon":"address-card"},"utilities":{"tag":"utilities","icon":"plug"},"iot":{"tag":"iot","icon":"microchip"},"uncategorized":{"tag":"uncategorized","icon":"square"}}')},1692:function(e,t,n){"use strict";n.r(t);n(15),n(36),n(37),n(31),n(17),n(63),n(33),n(50),n(21),n(22),n(53),n(18),n(54),n(27),n(67),n(777),n(62),n(35),n(19),n(34),n(271);var o=n(10),r=n(2),a=n(16),i=n(0),c=n.n(i),s=n(1),u=n.n(s),l=n(1555),p=n.n(l),d=n(297),f=n(502),b=n(393),h=n(396),y=n(504),m=n(1481),g=n(153),O=n(162),v=n(370),N=n(372),j=n(371),w=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new O.CRESTv2_1(Object(j.a)("/realm-config/authentication/authenticationtrees/nodes/".concat(t),e),{middleware:[v.a]})},P=function(e,t,n,o){return Object(N.a)(w(e,n).update(o,t))},E=function(e,t,n){return w(e,t).get(n)},S=function(e,t){return w(e,t).action("schema")},C=function(e,t){return w(e,t).action("template")},R=function(e,t,n){return w(e,n).action("listOutcomes",{body:t})},q=function(e,t,n){return w(e,t).delete(n)},D=n(352),T=n(758),_=n(503),I=n(351),x=n(349),k=n(296);n(1422);var M=function e(t,n){var o,a,i,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=[];if(Object(r.find)(c,function(e){return Object(r.findKey)(e)===t}))s.push(c);else{c.push((o={},a=t,i=n[t],a in o?Object.defineProperty(o,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[a]=i,o));var u=n[t].connections;Object(r.isEmpty)(u)?s.push(c):Object(r.forEach)(Object(r.keys)(u).sort(),function(t){Object(r.forEach)(e(u[t],n,Object(r.clone)(c)),function(e){s.push(e)})})}return s.sort(function(e,t){return t.length-e.length})},F=(n(185),function(e){var t=[];return Object(r.chain)(e).map(function(e){var n=Object(r.map)(e,function(e){return-1===Object(r.findIndex)(t,e)?(t.push(e),e):null});return Object(r.filter)(n,function(e){return!Object(r.isEmpty)(e)}).length>0?n:null}).compact().value()});function A(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var L=function(e){var t=F(e);return Object(r.map)(r.zip.apply(void 0,A(t)),function(e){return Object(r.compact)(e)})},U=(n(368),function(e,t){return Object(r.map)(e,function(e){return Object(r.reduce)(e,function(e,n){return e+t[Object(r.findKey)(n)].height+25},25)})}),Y=function(e,t,n){var o=function(e,t){return Object(r.map)(e,function(e){return Object(r.reduce)(e,function(e,n){return t[Object(r.findKey)(n)].width+50>e?t[Object(r.findKey)(n)].width+50:e},50)})}(e.slice(0,t),n);return Object(r.reduce)(o,function(e,t){return e+t},50)},W=function(e,t,n,o){var a=e[t].slice(0,n),i=Object(r.reduce)(a,function(e,t){return e+o[Object(r.findKey)(t)].height+25},25);return function(e,t,n){var o=U(e,n);return(Object(r.max)(o)-o[t])/2}(e,t,o)+i},X=function(e,t,n){var o=Object(r.max)(U(t,n)),a=50;return Object(r.chain)(e).map(function(e,t){return{id:t,x:(r=n[t].width,i=a,a=a+50+r,i),y:o+25};var r,i}).sortBy("id").value()};function z(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var K=function(e,t){var n=Object(r.keys)(e),o=Object(r.map)(r.union.apply(void 0,z(t)),function(e){return Object(r.findKey)(e)}),a=Object(r.difference)(n,o);return r.pick.apply(void 0,[e].concat(z(a)))},B=function(e,t){return Object(r.chain)(e).map(function(n,o){return Object(r.map)(n,function(n,a){return{id:Object(r.findKey)(n),x:Y(e,o,t),y:W(e,o,a,t)}})}).flatten().value()},H=function(e,t,n){var o=M(e,t),a=L(o),i=K(t,a),c=B(a,n),s=X(i,a,n);return Object(r.keyBy)(c.concat(s),"id")},G=n(1402),V=n(1509),J=(n(81),n(1482)),Q=n(25),Z=n(4),$=n.n(Z),ee=n(1604),te=n.n(ee),ne=n(1517),oe=n.n(ne),re=(n(115),n(159),n(144),n(124),n(441)),ae=n(440),ie=function(e,t){var n=t.toLowerCase();return Object(r.filter)(e,function(e){var t=e.name,o=e.tags;return t.toLowerCase().includes(n)||o&&o.join().toLowerCase().includes(n)})},ce="NodeTypeItem#NEW_NODE_TYPE",se="NodeTypeItem#PAGE_CHILD_NODE_TYPE",ue=n(379),le=function(e){var t=e.connectDragSource,n=e.displayName,o=e.filter,r=e.icon,a=e.isDragging,i=e.nodeType,c=e.tags,s=o&&c&&c.length?u.a.createElement("div",{style:{margin:"2px 0 0 -7px"}},c.map(function(e){return u.a.createElement(Q.b,{key:"".concat(n).concat(e),style:{border:"1px solid #cadeda",color:"#519387",backgroundColor:"#f1f6f5",marginRight:2}},u.a.createElement(ue.a,{match:o},e))})):void 0;return t(u.a.createElement("div",{className:$()({"edit-tree-type-item-selected":a,"authtree-content-left-item":!0}),"data-node-type":i},u.a.createElement(Q.w,null,u.a.createElement(Q.w.Body,null,u.a.createElement("span",{className:"fa-stack authtree-content-left-item-icon"},u.a.createElement("i",{className:"fa fa-circle fa-stack-2x text-primary"}),u.a.createElement("i",{className:"fa fa-".concat(r," fa-stack-1x fa-inverse")})),u.a.createElement(ue.a,{match:o},n),s))))};le.propTypes={connectDragSource:c.a.func.isRequired,displayName:c.a.string.isRequired,filter:c.a.string,icon:c.a.string.isRequired,isDragging:c.a.bool.isRequired,nodeType:c.a.string.isRequired,tags:c.a.arrayOf(c.a.string)};var pe=Object(J.DragSource)(ce,{beginDrag:function(e){return{displayName:e.displayName,nodeType:e.nodeType}}},function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}})(le);function de(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],o=!0,r=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(o=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(e){r=!0,a=e}finally{try{o||null==c.return||c.return()}finally{if(r)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var fe=function(e){var t=e.filter,n=e.nodeTypes,o=de(Object(s.useState)(n),2),i=o[0],c=o[1];return Object(s.useEffect)(function(){var e=ie(n,t);c(e)},[t,n]),Object(r.isEmpty)(i)?u.a.createElement("div",{className:"text-muted text-center"},Object(a.b)("console.common.noResults")):Object(r.map)(i,function(e){var n=e._id,o=e.icon,r=e.name,a=e.tags;return u.a.createElement(pe,{displayName:r,filter:t,icon:o,key:n,nodeType:n,tags:a})})};fe.propTypes={filter:c.a.string.isRequired,nodeTypes:c.a.objectOf(c.a.shape({_id:c.a.string.isRequired,icon:c.a.string.isRequired,name:c.a.string.isRequired,tags:c.a.arrayOf(c.a.string.isRequired).isRequired})).isRequired};var be=fe=Object(G.a)(fe,function(e){return{nodeTypes:e.local.config.realm.authentication.trees.nodeTypes.list}});function he(e){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ye(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function me(e){return(me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ge(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oe(e,t){return(Oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ne=function(e){function t(){var e,n,o,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return o=this,r=(e=me(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==he(r)&&"function"!=typeof r?ge(o):r,ve(ge(n),"state",{isOpen:n.props.defaultIsOpen}),ve(ge(n),"handleHeaderClick",function(e){e.preventDefault(),n.setState({isOpen:!n.state.isOpen})}),n}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oe(e,t)}(t,s["Component"]),n=t,(o=[{key:"render",value:function(){var e=this.props,t=e.group,n=e.groupKey,o=Object(r.map)(Object(r.sortBy)(t,function(e){return e.name.toUpperCase()}),function(e){var t=e._id,n=e.icon,o=e.name,r=e.tags;return u.a.createElement(pe,{displayName:o,icon:n,key:t,nodeType:t,tags:r})});return Object(r.isEmpty)(t)?"":u.a.createElement("div",{className:"clearfix edit-tree-node-type-item-tag-group"},u.a.createElement(Q.c,{bsClass:"link",className:"text-uppercase text-muted",componentClass:"h5",onClick:this.handleHeaderClick},Object(a.b)("console.authentication.trees.edit.nodes.nodeTypes.groups.".concat(n)),u.a.createElement("i",{className:$()({fa:!0,"fa-angle-down":this.state.isOpen,"fa-angle-up":!this.state.isOpen,"pull-right":!0})})),u.a.createElement(Q.h,{in:this.state.isOpen},u.a.createElement("div",null,o)))}}])&&ye(n.prototype,o),i&&ye(n,i),t}();ve(Ne,"propTypes",{defaultIsOpen:c.a.bool.isRequired,group:c.a.arrayOf(c.a.shape({_id:c.a.string.isRequired,icon:c.a.string.isRequired,name:c.a.string.isRequired,tags:c.a.arrayOf(c.a.string)})).isRequired,groupKey:c.a.string.isRequired});var je=Ne,we=n(1484);function Pe(e){return(Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ee(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Se(e){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ce(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Re(e,t){return(Re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var De=function(e){function t(){var e,n,o,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return o=this,r=(e=Se(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==Pe(r)&&"function"!=typeof r?Ce(o):r,qe(Ce(n),"state",{filter:""}),qe(Ce(n),"handleFilterChange",function(e){n.setState({filter:e.target.value})}),qe(Ce(n),"handleFilterClear",function(){n.setState({filter:""})}),n}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Re(e,t)}(t,s["Component"]),n=t,(o=[{key:"render",value:function(){var e=Object(r.isEmpty)(this.state.filter)?Object(r.map)(this.props.groupedNodeTypes,function(e,t){return u.a.createElement(je,{defaultIsOpen:"basicAuthentication"===t,group:e,groupKey:t,key:t})}):u.a.createElement(be,{filter:this.state.filter});return u.a.createElement("div",{className:"authtree-content-side authtree-content-left"},u.a.createElement("h4",{className:"authtree-content-side-title"},Object(a.b)("console.authentication.trees.edit.nodes.nodeTypes.title")),u.a.createElement(we.a,{isResetEnabled:!!this.state.filter,label:Object(a.b)("console.authentication.trees.edit.nodes.nodeTypes.label"),onBlur:this.handleFilterChange,onChange:this.handleFilterChange,onClear:this.handleFilterClear,value:this.state.filter}),u.a.createElement("div",null,e))}}])&&Ee(n.prototype,o),i&&Ee(n,i),t}();De.propTypes={groupedNodeTypes:c.a.objectOf(c.a.array)};var Te=De=Object(G.a)(De,function(e){return{groupedNodeTypes:e.local.config.realm.authentication.trees.nodeTypes.grouped}}),_e=n(1624),Ie=n(1407),xe=n(52),ke=n(1400),Me=n(1401);function Fe(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(n,!0).forEach(function(t){Ue(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ue(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ye(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],o=!0,r=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(o=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(e){r=!0,a=e}finally{try{o||null==c.return||c.return()}finally{if(r)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var We={name:Object(a.b)("console.authentication.trees.edit.nodes.success.title"),_id:g.g,tags:["basic authentication"]},Xe={name:Object(a.b)("console.authentication.trees.edit.nodes.failure.title"),_id:g.b,tags:["basic authentication"]},ze=function(e){var t=e.router,n=e.setGroupedNodeTypes,o=e.setNodeTypes,a=Ye(Object(s.useState)(!0),2),i=a[0],c=a[1],l=t.params[0];return Object(s.useEffect)(function(){(function(e){return w(e).action("getAllTypes")})(l).then(function(e){var t=Object(r.map)(Le({failureNode:Xe,successNode:We},e.result),function(e){var t=Object(r.find)(_e,function(t){return e.tags.join().toLowerCase().includes(t.tag.toLowerCase())});return e.icon=t?t.icon:_e.uncategorized.icon,e}),a=Object(r.sortBy)(t,function(e){return e.name.toUpperCase()}),i=Object(r.reduce)(_e,function(e,t,n){var o=t.tag.toLowerCase();return e[n]=Object(r.reduce)(a,function(e,t){return t.tags.join().toLowerCase().includes(o)&&e.push(t),e},[]),e},{}),s=Object(r.map)(_e,"tag"),u=a.filter(function(e){return!!Object(r.isEmpty)(e.tags)||!s.some(function(t){return e.tags.includes(t)})}),l=Object(r.mapValues)(Le({},i,{uncategorized:[].concat(Fe(i.uncategorized),Fe(u))}),function(e){return e});n(l),o(a),c(!1)},function(e){return xe.a.addMessage({response:e,type:xe.a.TYPE_DANGER})})},[l,n,o]),i?u.a.createElement(Ie.a,null):u.a.createElement(Te,null)};ze.propTypes={router:Me.a,setGroupedNodeTypes:c.a.func.isRequired,setNodeTypes:c.a.func.isRequired},ze=Object(G.a)(ze,function(e){return{groupedNodeTypes:e.local.config.realm.authentication.trees.nodeTypes.grouped,nodeTypes:e.local.config.realm.authentication.trees.nodeTypes.list}},function(e){return{setGroupedNodeTypes:Object(o.a)(ae.b,e),setNodeTypes:Object(o.a)(re.b,e)}});var Ke=ze=Object(ke.a)(ze);function Be(e){return(Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function He(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ge(e){return(Ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ve(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Je(e,t){return(Je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qe=function(e){function t(){var e,n,o,r,a,i,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var s=arguments.length,u=new Array(s),l=0;l<s;l++)u[l]=arguments[l];return o=this,r=(e=Ge(t)).call.apply(e,[this].concat(u)),n=!r||"object"!==Be(r)&&"function"!=typeof r?Ve(o):r,a=Ve(n),c=function(e){n.props.onDisplayNameChange(n.props.nodeId,e.target.value)},(i="handleDisplayNameChange")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Je(e,t)}(t,s["Component"]),n=t,(o=[{key:"render",value:function(){var e=!Object(r.isEmpty)(this.props.nodeName);return u.a.createElement(Q.k,null,u.a.createElement(Q.m,{controlId:Object(r.uniqueId)("nodeDisplayName"),validationState:e?null:"error"},u.a.createElement(Q.i,null,Object(a.b)("console.authentication.trees.edit.nodes.selectedNode.nodeName")),u.a.createElement(Q.l,{onBlur:this.handleDisplayNameChange,onChange:this.handleDisplayNameChange,type:"text",value:this.props.nodeName})))}}])&&He(n.prototype,o),i&&He(n,i),t}();Qe.propTypes={nodeId:c.a.string,nodeName:c.a.string,onDisplayNameChange:c.a.func.isRequired};var Ze=Qe,$e=n(375),et=n(217);function tt(e){return(tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function ot(e){return(ot=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function at(e,t){return(at=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function it(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ct=function(e){function t(){var e,n,o,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return o=this,r=(e=ot(t)).call.apply(e,[this].concat(i)),n=!r||"object"!==tt(r)&&"function"!=typeof r?rt(o):r,it(rt(n),"handleChange",function(e){var t=e.formData;n.props.onFieldChange(t),n.props.onPropertiesChange(n.props.nodeId,n.props.nodeType,t)}),it(rt(n),"handleSubmit",function(){n.props.onPropertiesChange(n.props.nodeId,n.props.nodeType,n.props.properties)}),n}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&at(e,t)}(t,s["Component"]),n=t,(o=[{key:"render",value:function(){var e,t,n,o=Object(r.get)(this.props.properties,"_type.name");return this.props.isExpanded&&o&&(e=u.a.createElement("h4",{className:"authtree-content-side-title text-primary"},o),t=u.a.createElement(Ze,{nodeId:this.props.nodeId,nodeName:this.props.nodeName,onDisplayNameChange:this.props.onDisplayNameChange}),n=Object(r.has)(this.props.schema,"properties")?u.a.createElement("span",null,u.a.createElement("hr",null),u.a.createElement(et.a,{editValidationMode:!this.props.isNew,formData:this.props.properties,liveValidate:!0,onChange:this.handleChange,onSubmit:this.handleSubmit,schema:this.props.schema})):u.a.createElement(Q.a,{bsStyle:"info"},u.a.createElement("p",null,Object(a.b)("console.authentication.trees.edit.nodes.properties.noProperties")))),u.a.createElement("div",{className:$()({"authtree-content-side":!0,"authtree-content-right":!0,expanded:!!this.props.isExpanded})},e,t,u.a.createElement($e.a,null,n))}}])&&nt(n.prototype,o),i&&nt(n,i),t}();ct.propTypes={isExpanded:c.a.bool.isRequired,isNew:c.a.bool.isRequired,nodeId:c.a.string,nodeName:c.a.string,nodeType:c.a.string,onDisplayNameChange:c.a.func.isRequired,onFieldChange:c.a.func.isRequired,onPropertiesChange:c.a.func.isRequired,properties:c.a.objectOf(c.a.any),schema:c.a.objectOf(c.a.any)};var st=ct;function ut(){return(ut=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function lt(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var pt=function(e){var t=e.className,n=e.title,o=lt(e,["className","title"]);return u.a.createElement(Q.c,ut({},o,{className:$()(t,{"fr-btn-secondary":!0}),"data-title":n}))};pt.propTypes={className:c.a.string,title:c.a.string};var dt=pt,ft=function(){return u.a.createElement("div",{className:"authtree-btn-toolbar-divider"})},bt=function(e){var t=e.children,n=e.placement,o=e.tooltip,r=u.a.createElement(Q.C,{id:o},o);return u.a.createElement(Q.v,{delayShow:500,overlay:r,placement:n,rootClose:!0},t)};bt.propTypes={children:c.a.node,placement:c.a.oneOf(["bottom","top"]).isRequired,tooltip:c.a.string.isRequired};var ht=bt,yt=function(e){var t=e.invertTooltipPlacement,n=e.isDeleteNodeEnabled,o=e.onAutoLayout,r=e.onFullscreenToggle,i=e.onNodeDelete,c=e.onTreeSave,s=t?"bottom":"top",l=Object(a.b)("console.authentication.trees.edit.toolbar.autoLayout"),p=Object(a.b)("console.authentication.trees.edit.toolbar.fullscreen"),d=Object(a.b)("console.authentication.trees.edit.toolbar.deleteNode");return u.a.createElement(Q.e,{className:"authtree-btn-toolbar"},u.a.createElement(ht,{placement:s,tooltip:l},u.a.createElement(dt,{onClick:o,title:l},u.a.createElement("i",{className:"fa fa-sitemap fa-rotate-270"}))),u.a.createElement(ht,{placement:s,tooltip:p},u.a.createElement(dt,{onClick:r,title:p},u.a.createElement("i",{className:"fa fa-arrows-alt"}))),u.a.createElement(ft,null),u.a.createElement(ht,{placement:s,tooltip:d},u.a.createElement(dt,{disabled:!n,onClick:i,title:d},u.a.createElement("i",{className:"fa fa-trash"}))),u.a.createElement(Q.c,{bsStyle:"primary",className:"pull-right",onClick:c},Object(a.b)("common.form.save")))};yt.propTypes={invertTooltipPlacement:c.a.bool.isRequired,isDeleteNodeEnabled:c.a.bool.isRequired,onAutoLayout:c.a.func.isRequired,onFullscreenToggle:c.a.func.isRequired,onNodeDelete:c.a.func.isRequired,onTreeSave:c.a.func.isRequired};var mt=yt;function gt(){return(gt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function Ot(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var vt=function(e){var t=e.className,n=e.isFullscreen,o=Ot(e,["className","isFullscreen"]);return u.a.createElement("div",gt({},o,{className:$()(t,{fullscreen:n})}))};vt.propTypes={className:c.a.string,isFullscreen:c.a.bool.isRequired};var Nt=vt,jt=n(1506),wt=n(41),Pt=function(e){var t=e.numOfDroppedFragments,n=Object(jt.a)(wt.a.currentRoute.pattern,t);return n?u.a.createElement("ol",{className:"breadcrumb"},Object(r.map)(n,function(e){var t=e.path,n=e.title;return t?u.a.createElement("li",{key:"breadcrumb-".concat(t).concat(n)},u.a.createElement("a",{href:t},n)):u.a.createElement("li",{key:"breadcrumb-".concat(n)},n)})):null};Pt.propTypes={numOfDroppedFragments:c.a.number};var Et=Pt,St=function(e){var t=e.children,n=e.fluid;return u.a.createElement("div",{className:"subnav-container"},u.a.createElement(Q.n,{fluid:n},u.a.createElement(Q.y,null,u.a.createElement("nav",{className:"navbar navbar-default"},u.a.createElement(Q.g,{className:"navbar-header",lg:2,md:3,sm:3,xs:4},u.a.createElement("div",{className:"ellipsis"},u.a.createElement("strong",null,t))),u.a.createElement(Q.g,{className:"ellipsis",lg:10,md:9,sm:9,xs:8},u.a.createElement(Et,null))))))};St.propTypes={children:c.a.node,fluid:c.a.bool};var Ct=St,Rt=n(1505),qt=function(e){var t=e.router.params[0],n=Object(Rt.a)(t),o="#".concat(wt.a.getLink(wt.a.configuration.routes.realmDefault,[encodeURIComponent(t)]));return u.a.createElement("span",null,u.a.createElement("i",{className:"fa fa-cloud"})," ",u.a.createElement("a",{href:o},n))};qt.propTypes={router:Me.a};var Dt=Object(ke.a)(qt),Tt=function(e){var t=e.start,n=e.startCp,o=e.center,r=e.endCp,a=e.end,i=o?"".concat(o.x," ").concat(o.y," , ").concat(o.x," ").concat(o.y," S"):"",c="M".concat(t.x," ").concat(t.y," C").concat(n.x," ").concat(n.y,", "),s="".concat(r.x," ").concat(r.y,", ").concat(a.x," ").concat(a.y);return"".concat(c).concat(i).concat(s)},_t=function(e,t){var n=50;Math.abs(e.y-t.y)<50&&(n=Math.abs(e.y-t.y));var o=Math.abs(.2*(e.x-t.x));return o<n?n:o},It=function(e){var t=e.end,n=e.isNew,o=e.start,r=e.isInputForSelectedNode,a=e.isOutputForSelectedNode,i=Math.abs(o.y-t.y)<150,c=t.x+o.width<=o.x&&i?function(e,t){var n=(e.height+e.width)/2||0,o=_t(e,t),r={x:e.x+o,y:e.y+n},a={x:t.x-o,y:t.y+50};return Tt({start:e,startCp:r,endCp:a,end:t})}(o,t):function(e,t){var n=_t(e,t),o={x:e.x-(e.x-t.x)/2,y:e.y-(e.y-t.y)/2},r={x:e.x+n,y:e.y},a={x:t.x-n,y:t.y};return Tt({start:e,startCp:r,center:o,endCp:a,end:t})}(o,t);return u.a.createElement("path",{className:$()({"authtree-connector":!0,"authtree-connector-new":n,"authtree-connector-selected-node-input":r,"authtree-connector-selected-node-output":a}),d:c,id:t.id?"connection-".concat(o.id,"-").concat(t.id):"connection-".concat(o.id)})};It.defaultProps={isInputForSelectedNode:!1,isNew:!1,isOutputForSelectedNode:!1},It.propTypes={end:c.a.shape({id:c.a.string,x:c.a.number,y:c.a.number}).isRequired,isInputForSelectedNode:c.a.bool,isNew:c.a.bool,isOutputForSelectedNode:c.a.bool,start:c.a.shape({id:c.a.string.isRequired,height:c.a.number.isRequired,width:c.a.number.isRequired,x:c.a.number.isRequired,y:c.a.number.isRequired}).isRequired};var xt=It,kt=n(1625),Mt=n.n(kt);function Ft(e){return(Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function At(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Lt(e){return(Lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ut(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yt(e,t){return(Yt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Wt=function(e){function t(){var e,n,o,r,a,i,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var s=arguments.length,u=new Array(s),l=0;l<s;l++)u[l]=arguments[l];return o=this,r=(e=Lt(t)).call.apply(e,[this].concat(u)),n=!r||"object"!==Ft(r)&&"function"!=typeof r?Ut(o):r,a=Ut(n),c=function(e){n.props.onMouseDown(e,n.props.id)},(i="handleMouseDown")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yt(e,t)}(t,s["Component"]),n=t,(o=[{key:"render",value:function(){var e=Object(r.uniqueId)("outcome-".concat(this.props.id));return u.a.createElement("div",null,u.a.createElement("label",{className:"sr-only",htmlFor:e},this.props.name),u.a.createElement("div",{className:$()({"authtree-outcome":!0,"authtree-outcome-invalid":!this.props.isConnected}),id:e,onMouseDown:this.handleMouseDown,onMouseUp:this.props.onMouseUp,role:"presentation"}))}}])&&At(n.prototype,o),a&&At(n,a),t}();Wt.propTypes={id:c.a.string.isRequired,isConnected:c.a.bool.isRequired,name:c.a.string.isRequired,onMouseDown:c.a.func.isRequired,onMouseUp:c.a.func.isRequired};var Xt=Wt;function zt(e){return(zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Bt(e){return(Bt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ht(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gt(e,t){return(Gt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Vt=function(e){function t(){var e,n,o,r,a,i,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var s=arguments.length,u=new Array(s),l=0;l<s;l++)u[l]=arguments[l];return o=this,r=(e=Bt(t)).call.apply(e,[this].concat(u)),n=!r||"object"!==zt(r)&&"function"!=typeof r?Ht(o):r,a=Ht(n),c=function(e){n.props.onMouseDown(e,n.props.id)},(i="handleMouseDown")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gt(e,t)}(t,s["Component"]),n=t,(o=[{key:"render",value:function(){var e=Object(r.uniqueId)("outcome-".concat(this.props.id));return u.a.createElement("li",{className:$()({"authtree-outcome":!0,"authtree-multi-outcome":!0,"authtree-outcome-invalid":!this.props.isConnected}),id:e,onMouseDown:this.handleMouseDown,onMouseUp:this.props.onMouseUp,role:"presentation"},u.a.createElement("label",{htmlFor:e},this.props.name))}}])&&Kt(n.prototype,o),a&&Kt(n,a),t}();Vt.propTypes={id:c.a.string.isRequired,isConnected:c.a.bool.isRequired,name:c.a.string.isRequired,onMouseDown:c.a.func.isRequired,onMouseUp:c.a.func.isRequired};var Jt=Vt;function Qt(e){return(Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function $t(e){return($t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function en(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tn(e,t){return(tn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nn=function(e){function t(){var e,n,o,r,a,i,c;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var s=arguments.length,u=new Array(s),l=0;l<s;l++)u[l]=arguments[l];return o=this,r=(e=$t(t)).call.apply(e,[this].concat(u)),n=!r||"object"!==Qt(r)&&"function"!=typeof r?en(o):r,a=en(n),c=function(e){n.props.onMeasure&&n.props.onMeasure(n.props.id,e)},(i="handleMeasure")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tn(e,t)}(t,s["Component"]),n=t,(o=[{key:"render",value:function(){return u.a.createElement("div",{onMouseDown:this.props.onMouseDown,role:"presentation"},u.a.createElement(oe.a,{onMeasure:this.handleMeasure},u.a.createElement("div",{className:$()(this.props.className,{"authtree-node":!0,"authtree-node-selected":this.props.isSelected}),onMouseUp:this.props.onMouseUp,role:"presentation"},this.props.titleDecoration,u.a.createElement("div",{className:"authtree-node-title"},this.props.node.displayName),this.props.children)))}}])&&Zt(n.prototype,o),r&&Zt(n,r),t}();nn.defaultProps={className:""},nn.propTypes={children:c.a.node,className:c.a.PropTypes.string,id:c.a.string.isRequired,isSelected:c.a.bool.isRequired,node:c.a.shape({displayName:c.a.string.isRequired}).isRequired,onMeasure:c.a.func,onMouseDown:c.a.func.isRequired,onMouseUp:c.a.func,titleDecoration:c.a.node};var on=nn;function rn(e){return(rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function an(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function cn(e){return(cn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function un(e,t){return(un=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ln(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pn=function(e){function t(){var e,n,o,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,c=new Array(i),s=0;s<i;s++)c[s]=arguments[s];return o=this,a=(e=cn(t)).call.apply(e,[this].concat(c)),n=!a||"object"!==rn(a)&&"function"!=typeof a?sn(o):a,ln(sn(n),"handleDrag",function(e,t){var o=t.x,r=t.y;n.props.onDrag(n.props.id,o,r,o+e.offsetX,r+e.offsetY)}),ln(sn(n),"handleDragStop",function(e,t){var o=t.x,r=t.y;n.props.onDragStop(n.props.id,o,r,o+e.offsetX,r+e.offsetY)}),ln(sn(n),"handleNodeMouseDown",function(){var e=n.isStartNode()?null:n.props.id;n.props.onSelect(e,n.props.node.nodeType)}),ln(sn(n),"handleNodeMouseUp",function(){n.isStartNode()||n.props.onConnectionFinish(n.props.id)}),ln(sn(n),"handleOutcomeMouseDown",function(e,t){e.stopPropagation(),n.props.onConnectionStart(n.props.id,e,t)}),ln(sn(n),"handleOutcomeMouseUp",function(e){e.stopPropagation()}),ln(sn(n),"isStartNode",function(){return n.props.id===Object(r.findKey)(Object(g.j)())}),n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&un(e,t)}(t,s["Component"]),n=t,(o=[{key:"render",value:function(){var e=this,t=this.props.node._outcomes,n="",o="";if(1===t.length){var a=t[0].id;n=u.a.createElement("div",{className:"pull-right"},u.a.createElement(Xt,{id:a,isConnected:Object(r.has)(this.props.node.connections,a),name:t[0].displayName,onMouseDown:this.handleOutcomeMouseDown,onMouseUp:this.handleOutcomeMouseUp}))}else t.length>1&&(o=u.a.createElement(Q.f,{className:"authtree-node-outcomes"},u.a.createElement("ul",{className:"pull-right"},Object(r.map)(t,function(t){var n=t.id,o=t.displayName;return u.a.createElement(Jt,{id:n,isConnected:Object(r.has)(e.props.node.connections,n),key:n,name:o,onMouseDown:e.handleOutcomeMouseDown,onMouseUp:e.handleOutcomeMouseUp})}))));var i=Object(r.size)(this.props.node.connections)===Object(r.size)(this.props.node._outcomes);return u.a.createElement(Mt.a,{bounds:{top:20,left:20},onDrag:this.handleDrag,onMouseDown:this.handleNodeMouseDown,onStop:this.handleDragStop,position:{x:this.props.node.x,y:this.props.node.y}},u.a.createElement("div",{id:"node-".concat(this.props.id)},u.a.createElement(on,{className:$()({"authtree-node-has-input":!this.isStartNode(),"authtree-node-has-input-invalid":!this.props.isInputConnected,"authtree-node-invalid":!this.isStartNode()&&!this.props.isInputConnected||!i}),id:this.props.id,isSelected:this.props.isSelected,node:this.props.node,onMeasure:this.props.onMeasure,onMouseDown:this.handleNodeMouseDown,onMouseUp:this.handleNodeMouseUp,titleDecoration:n},this.props.children,o)))}}])&&an(n.prototype,o),a&&an(n,a),t}();pn.propTypes={children:c.a.node,id:c.a.string.isRequired,isInputConnected:c.a.bool.isRequired,isSelected:c.a.bool.isRequired,node:c.a.shape({_outcomes:c.a.arrayOf(c.a.shape({id:c.a.string.isRequired,displayName:c.a.string.isRequired})).isRequired,connections:c.a.objectOf(c.a.string),displayName:c.a.string.isRequired,nodeType:c.a.string.isRequired,x:c.a.number,y:c.a.number}).isRequired,onConnectionFinish:c.a.func.isRequired,onConnectionStart:c.a.func.isRequired,onDrag:c.a.func.isRequired,onDragStop:c.a.func.isRequired,onMeasure:c.a.func.isRequired,onSelect:c.a.func.isRequired};var dn=pn,fn=function(e){var t=e.node,n=e.isDragging,o=e.isSelected,r=e.connectDragSource,a=e.onMouseDown;return n?"":r(u.a.createElement("div",{className:"page-list-child",id:"node-".concat(t._id)},u.a.createElement(on,{id:t._id,isInPage:!0,isSelected:o,key:t._id,node:t,onMouseDown:a})))};fn.propTypes={connectDragSource:c.a.func.isRequired,isDragging:c.a.bool.isRequired,isSelected:c.a.bool.isRequired,node:c.a.shape({_id:c.a.string.isRequired}).isRequired,onMouseDown:c.a.func.isRequired,pageId:c.a.string.isRequired};var bn=Object(J.DragSource)(se,{beginDrag:function(e){return{nodeId:e.node._id,pageId:e.pageId}}},function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}})(fn),hn=n(350),yn=n(64);function mn(e){return(mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function On(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function vn(e){return(vn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Nn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jn(e,t){return(jn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Pn=function(e){function t(){var e,n,o,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,c=new Array(i),s=0;s<i;s++)c[s]=arguments[s];return o=this,a=(e=vn(t)).call.apply(e,[this].concat(c)),n=!a||"object"!==mn(a)&&"function"!=typeof a?Nn(o):a,wn(Nn(n),"handleMeasure",function(e){Object(r.isEqual)(e,n.state)||n.setState(e)}),n}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jn(e,t)}(t,s["Component"]),n=t,(o=[{key:"componentDidUpdate",value:function(){var e=this.props.pageNodeLeft-this.props.pageNodeX,t=this.props.pageNodeTop-this.props.pageNodeY,n={height:this.state.height,width:this.state.width,x:this.state.left-e,y:this.state.top-t};yn.a.dispatch(Object(hn.a)(this.props.id,n))}},{key:"handleAddNode",value:function(e){if(this.props.numberOutcomes>1)xe.a.addMessage({message:Object(a.b)("console.authentication.trees.edit.nodes.pages.alreadyComplete"),type:xe.a.TYPE_DANGER});else{var t=this.props.onNewNodeCreate(e),n=Object(r.cloneDeep)(this.props.pageConfig);n.nodes.push(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gn(n,!0).forEach(function(t){wn(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gn(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{_id:t})),yn.a.dispatch(Object(d.a)(n)),yn.a.dispatch(Object(k.a)(t,this.props.id)),this.props.onNodePropertiesChange(this.props.id,g.d,n)}}},{key:"handleMoveNodeToPage",value:function(e){var t=e.nodeId,n=e.pageId;if(n!==this.props.id){yn.a.dispatch(Object(k.a)(t,n));var o=Object(r.cloneDeep)(this.props.pageConfig);this.props.onNodePropertiesChange(this.props.id,g.d,o)}}},{key:"isDraggingNodeOver",value:function(e){if(!e)return!1;var t=[g.a,g.e,g.f],n=[g.c,g.d];if(Object(r.includes)(t,e.id)||Object(r.includes)(n,e.type))return!1;var o=yn.a.getState().local.config.realm.authentication.trees.current.nodes.pages.positions[this.props.id];return e.mouseX>o.x&&e.mouseX<o.x+o.width&&e.mouseY>o.y&&e.mouseY<o.y+o.height}},{key:"render",value:function(){var e=this,t=this.props,n=t.canDrop,o=t.connectDropTarget,r=t.draggingNode,i=t.id,c=t.isDragAndDropOver,s=t.pageConfig,l=t.onNodeSelect,p=c&&n||this.isDraggingNodeOver(r),d=function(e,t){return function(n){n.stopPropagation(),l(e,t)}},f=s.nodes.map(function(t){return u.a.createElement(bn,{isSelected:t._id===e.props.selectedNodeId,key:t._id,node:t,onMouseDown:d(t._id,t.nodeType),pageId:i})});return 0===s.nodes.length&&f.push(u.a.createElement("small",{key:"noNodes"},Object(a.b)("console.authentication.trees.edit.nodes.pages.noNodes"))),o(u.a.createElement("div",null,u.a.createElement(oe.a,{onMeasure:this.handleMeasure},u.a.createElement(Q.f,{className:$()({"authtree-page-nodes":!0,"authtree-page-nodes-drag-hover":p})},f))))}}])&&On(n.prototype,o),i&&On(n,i),t}();Pn.propTypes={canDrop:c.a.bool.isRequired,connectDropTarget:c.a.func.isRequired,draggingNode:c.a.shape({id:c.a.string.isRequired,type:c.a.string.isRequired,mouseX:c.a.number.isRequired,mouseY:c.a.number.isRequired}),id:c.a.string.isRequired,isDragAndDropOver:c.a.bool.isRequired,numberOutcomes:c.a.number.isRequired,onNewNodeCreate:c.a.func.isRequired,onNodePropertiesChange:c.a.func.isRequired,onNodeSelect:c.a.func.isRequired,pageConfig:c.a.shape({nodes:c.a.arrayOf(c.a.shape({_id:c.a.string.isRequired})).isRequired}),pageNodeLeft:c.a.number.isRequired,pageNodeTop:c.a.number.isRequired,pageNodeX:c.a.number.isRequired,pageNodeY:c.a.number.isRequired,selectedNodeId:c.a.string};var En={drop:function(e,t,n){t.getItemType()===ce?n.handleAddNode(t.getItem()):n.handleMoveNodeToPage(t.getItem())},canDrop:function(e,t){var n=t.getItem().nodeType,o=t.getItemType(),a=[g.b,g.d,g.c,g.g];return o===se||!Object(r.includes)(a,n)}};var Sn=Object(J.DropTarget)([ce,se],En,function(e,t){return{connectDropTarget:e.dropTarget(),isDragAndDropOver:t.isOver(),canDrop:t.canDrop()}})(Pn);function Cn(e){return(Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rn(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function qn(e){return(qn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Dn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tn(e,t){return(Tn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _n=function(e){function t(e){var n,o,r,a,i,c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,r=qn(t).call(this,e),n=!r||"object"!==Cn(r)&&"function"!=typeof r?Dn(o):r,a=Dn(n),c=function(e,t){n.props.onMeasure(e,t),n.setState(t)},(i="handleMeasure")in a?Object.defineProperty(a,i,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[i]=c,n.state={left:0,top:0},n}var n,o,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tn(e,t)}(t,s["Component"]),n=t,(o=[{key:"render",value:function(){var e=this.props,t=e.draggingNode,n=e.id,o=e.isInputConnected,r=e.isSelected,a=e.node,i=e.onConnectionFinish,c=e.onConnectionStart,s=e.onDrag,l=e.onDragStop,p=e.onNewNodeCreate,d=e.onNodePropertiesChange,f=e.onSelect,b=e.pageConfig,h=e.selectedNodeId;return u.a.createElement(dn,{id:n,isInputConnected:o,isSelected:r,key:n,node:a,onConnectionFinish:i,onConnectionStart:c,onDrag:s,onDragStop:l,onMeasure:this.handleMeasure,onSelect:f,x:a.x,y:a.y},u.a.createElement(Sn,{draggingNode:t,id:n,localNodeProperties:this.props.localNodeProperties,numberOutcomes:a._outcomes.length,onConnectionFinish:i,onNewNodeCreate:p,onNodePropertiesChange:d,onNodeSelect:f,pageConfig:b,pageNodeLeft:this.state.left||0,pageNodeTop:this.state.top||0,pageNodeX:a.x,pageNodeY:a.y,selectedNodeId:h}))}}])&&Rn(n.prototype,o),r&&Rn(n,r),t}();_n.propTypes={draggingNode:c.a.shape({id:c.a.string.isRequired}),id:c.a.string.isRequired,isInputConnected:c.a.bool.isRequired,isSelected:c.a.bool.isRequired,localNodeProperties:c.a.objectOf(c.a.object).isRequired,node:c.a.shape({_outcomes:c.a.array.isRequired,x:c.a.number,y:c.a.number}).isRequired,onConnectionFinish:c.a.func.isRequired,onConnectionStart:c.a.func.isRequired,onDrag:c.a.func.isRequired,onDragStop:c.a.func.isRequired,onMeasure:c.a.func.isRequired,onNewNodeCreate:c.a.func.isRequired,onNodePropertiesChange:c.a.func.isRequired,onSelect:c.a.func.isRequired,pageConfig:c.a.shape({nodes:c.a.arrayOf(c.a.shape({_id:c.a.string.isRequired})).isRequired}),selectedNodeId:c.a.string};var In=_n;function xn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function kn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Mn(e,t,n,o){return{id:e,isInputConnected:n,isSelected:e===o.selectedNodeId,key:e,node:t,onConnectionFinish:o.onConnectionFinish,onConnectionStart:o.onConnectionStart,onDrag:o.onDrag,onDragStop:o.onDragStop,onMeasure:o.onMeasure,onSelect:o.onNodeSelect}}var Fn={createNode:function(e,t,n,o){return u.a.createElement(dn,Mn(e,t,n,o))},createPageNode:function(e,t,n,o){var r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xn(n,!0).forEach(function(t){kn(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xn(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},Mn(e,t,n,o),{draggingNode:o.draggingNode,localNodeProperties:o.localNodeProperties,nodesInPages:o.nodesInPages,onNewNodeCreate:o.onNewNodeCreate,onNodePropertiesChange:o.onNodePropertiesChange,pageConfig:o.localNodeProperties[e]||{nodes:[]},selectedNodeId:o.selectedNodeId});return u.a.createElement(In,r)}};function An(e){return(An="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ln(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function Un(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ln(n,!0).forEach(function(t){Kn(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ln(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Yn(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Wn(e){return(Wn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zn(e,t){return(zn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Bn=function(e,t,n,o){var a=e.width||0,i=Object(r.findIndex)(n,{id:o}),c=t.x+a,s=Object(r.size)(n),u=s-i;return{x:c,y:1===s?t.y+22:t.y+e.height-(17*u-2)}},Hn=function(e,t){var n=t.getBoundingClientRect();return{x:e.clientX+t.scrollLeft-n.left,y:e.clientY+t.scrollTop-n.top}},Gn=function(e){function t(e){var n,o,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,r=Wn(t).call(this,e),n=!r||"object"!==An(r)&&"function"!=typeof r?Xn(o):r,Kn(Xn(n),"handleConnectionStart",function(e,t,o){var r=n.domNode,a=Hn(t,r),i=r.ownerDocument;i.addEventListener("mousemove",n.handleNewConnectionMove),i.addEventListener("mouseup",n.handleNewConnectionFinish),n.setState({newConnectionFromNodeId:e,newConnectionFromOutcome:o,newConnectionEndX:a.x,newConnectionEndY:a.y})}),Kn(Xn(n),"handleNewConnectionMove",function(e){var t=Hn(e,n.domNode);n.setState({newConnectionEndX:t.x,newConnectionEndY:t.y})}),Kn(Xn(n),"handleNewConnectionFinish",function(){var e=n.domNode.ownerDocument;e.removeEventListener("mousemove",n.handleNewConnectionMove),e.removeEventListener("mouseup",n.handleNewConnectionFinish),n.setState({newConnectionFromNodeId:null})}),Kn(Xn(n),"handleConnectionFinish",function(e){null!==n.state.newConnectionFromNodeId&&n.props.onNewConnection(n.state.newConnectionFromNodeId,n.state.newConnectionFromOutcome,e)}),Kn(Xn(n),"handleSvgClick",function(){n.props.onNodeDeselect()}),Kn(Xn(n),"setRef",function(e){n.domNode=e}),n.state={newConnectionFromNodeId:null},n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zn(e,t)}(t,s["Component"]),n=t,(o=[{key:"componentWillUnmount",value:function(){var e=this.domNode.ownerDocument;e.removeEventListener("mousemove",this.handleNewConnectionMove),e.removeEventListener("mouseup",this.handleNewConnectionFinish)}},{key:"render",value:function(){var e=this,t=function(t,n,o,r,a){e.setState({draggingNodeId:t,draggingNodeX:n,draggingNodeY:o,mouseX:r,mouseY:a})},n=function(t,n,o,a,i){e.setState({draggingNodeId:null}),e.props.onNodeMove(t,Object(r.round)(n),Object(r.round)(o),Object(r.round)(a),Object(r.round)(i))},o=function(t,n){return e.props.onNodeDimensionsChange(t,n.height,n.width)},a=Object(r.reduce)(Object(r.map)(this.props.nodes,"connections"),function(e,t){return Object(r.union)(e,Object(r.values)(t))},[]),i=Object(r.omit)(this.props.nodes,Object(r.keys)(this.props.nodesInPages)),c=Object(r.map)(i,function(i,c){var s=e.props.localNodeProperties[e.state.draggingNodeId],u=Object(r.get)(s,"_type._id");return(Fn["create".concat(i.nodeType)]||Fn.createNode)(c,i,Object(r.includes)(a,c),{draggingNode:e.state.draggingNodeId&&{id:e.state.draggingNodeId,mouseX:e.state.mouseX,mouseY:e.state.mouseY,type:u,x:e.state.draggingNodeX,y:e.state.draggingNodeY},localNodeProperties:e.props.localNodeProperties,nodesInPages:e.props.nodesInPages,onConnectionFinish:e.handleConnectionFinish,onConnectionStart:e.handleConnectionStart,onDrag:t,onDragStop:n,onMeasure:o,onNewNodeCreate:e.props.onNewNodeCreate,onNodePropertiesChange:e.props.onNodePropertiesChange,onNodeSelect:e.props.onNodeSelect,selectedNodeId:e.props.selectedNodeId})}),s=Object(r.mapValues)(this.props.dimensions,function(t){return t.id===e.state.draggingNodeId?Un({},t,{x:e.state.draggingNodeX,y:e.state.draggingNodeY}):t}),l=function(t){return t===e.state.draggingNodeId?{x:e.state.draggingNodeX,y:e.state.draggingNodeY}:{x:e.props.nodes[t].x||0,y:e.props.nodes[t].y||0}},p=Object(r.chain)(this.props.nodes).map(function(t,n){var o=e.props.nodes[n];return Object(r.map)(o.connections,function(t,r){var a,i=s[n],c=l(n),p=s[t],d=l(t);if(i&&c&&p&&d){var f=Un({},i,{},Bn(i,c,o._outcomes,r),{id:n}),b=Un({id:t},{x:(a=d).x,y:a.y+22});return u.a.createElement(xt,{end:b,isInputForSelectedNode:e.props.selectedNodeId===t,isOutputForSelectedNode:e.props.selectedNodeId===n,key:"connection-".concat(f.id,"-").concat(b.id),start:f})}return null})}).flatten().value();if(null!==this.state.newConnectionFromNodeId){var d=this.props.dimensions[this.state.newConnectionFromNodeId],f=this.props.nodes[this.state.newConnectionFromNodeId],b=f.x,h=f.y,y=f._outcomes,m=Un({},d,{},Bn(d,{x:b,y:h},y,this.state.newConnectionFromOutcome),{id:this.state.newConnectionFromNodeId}),g={x:this.state.newConnectionEndX,y:this.state.newConnectionEndY};p.push(u.a.createElement(xt,{end:g,isNew:!0,key:"connection-".concat(m.id,"-").concat(p.length+1),start:m}))}return this.props.connectDropTarget(u.a.createElement("div",{className:$()({"authtree-editor-container":!0,"authtree-editor-container-dragging-connector":null!==this.state.newConnectionFromNodeId}),style:{height:this.props.containerHeight}},u.a.createElement("div",{className:"authtree-editor",ref:this.setRef},c,u.a.createElement("svg",{className:"authtree-editor-svg",onClick:this.handleSvgClick,style:{height:this.props.canvasHeight,width:this.props.canvasWidth}},p))))}}])&&Yn(n.prototype,o),a&&Yn(n,a),t}();Gn.propTypes={canvasHeight:c.a.number.isRequired,canvasWidth:c.a.number.isRequired,connectDropTarget:c.a.func.isRequired,containerHeight:c.a.number.isRequired,dimensions:c.a.objectOf(c.a.shape({id:c.a.string,height:c.a.number,width:c.a.number})),localNodeProperties:c.a.objectOf(c.a.shape({_type:c.a.shape({_id:c.a.string}),nodes:c.a.arrayOf(c.a.string)})).isRequired,nodes:c.a.objectOf(c.a.shape({_outcomes:c.a.arrayOf(c.a.shape({id:c.a.string.isRequired,displayName:c.a.string.isRequired})).isRequired,connections:c.a.objectOf(c.a.string).isRequired,x:c.a.number,y:c.a.number})).isRequired,nodesInPages:c.a.objectOf(c.a.string).isRequired,onNewConnection:c.a.func.isRequired,onNewNodeCreate:c.a.func.isRequired,onNodeDeselect:c.a.func.isRequired,onNodeDimensionsChange:c.a.func.isRequired,onNodeMove:c.a.func.isRequired,onNodePropertiesChange:c.a.func.isRequired,onNodeSelect:c.a.func.isRequired,selectedNodeId:c.a.string};var Vn={drop:function(e,t,n){if(!t.didDrop()){var o=n.domNode.getBoundingClientRect(),a=t.getInitialClientOffset().x-t.getInitialSourceClientOffset().x,i=t.getInitialClientOffset().y-t.getInitialSourceClientOffset().y,c={x:t.getClientOffset().x-o.left-a+15,y:t.getClientOffset().y-o.top-i};c.x=Object(r.max)([c.x,20]),c.y=Object(r.max)([c.y,20]),t.getItemType()===ce?e.onNewNodeCreate(t.getItem(),c):e.onNodeMove(t.getItem().nodeId,c.x,c.y,c.x+a,c.y+i)}}};var Jn=Object(J.DropTarget)([ce,se],Vn,function(e){return{connectDropTarget:e.dropTarget()}})(Gn);function Qn(e){return(Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function $n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zn(n,!0).forEach(function(t){ro(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zn(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function eo(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function to(e){return(to=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function no(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oo(e,t){return(oo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ro(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ao=Object(r.debounce)(function(e,t,n,o){e(t,n,o)},500,{leading:!0}),io=function(e){function t(e){var n,o,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,r=to(t).call(this,e),n=!r||"object"!==Qn(r)&&"function"!=typeof r?no(o):r,ro(no(n),"handleWindowResize",function(){n.forceUpdate()}),ro(no(n),"handleTreeMeasure",function(e){n.setState({containerWidth:e.width,containerX:e.left,containerY:e.top})}),ro(no(n),"handleNodeDelete",function(){n.props.onNodeDelete(n.props.selectedNode.id)}),ro(no(n),"handleNodePropertiesChange",function(e,t,o){ao(n.props.onNodePropertiesChange,e,t,o)}),n.state={containerWidth:0},n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oo(e,t)}(t,s["Component"]),n=t,(o=[{key:"UNSAFE_componentWillMount",value:function(){window.addEventListener("resize",Object(r.debounce)(this.handleWindowResize,100))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleWindowResize)}},{key:"render",value:function(){var e=this,t=this.props.isFullscreen?window.innerHeight-55:window.innerHeight-55-57-76-81,n=function(e,t,n,o){var a=Object(r.reduce)(e,function(e,n){return Object(r.max)([e,t[n.id].y+n.height])},0),i=Object(r.reduce)(e,function(e,n){return Object(r.max)([e,t[n.id].x+n.width])},0),c=Object(r.max)([n,a+20]);return{canvasWidth:Object(r.max)([o,i+20]),canvasHeight:c}}(this.props.dimensions,this.props.nodes,t,this.state.containerWidth),o=n.canvasHeight,a=n.canvasWidth;if(this.props.isFetching)return u.a.createElement(Ie.a,null);var i,c,l=(i=e.props.selectedNode.id,(c=e.props.nodesInPages[i])?e.props.localNodeProperties[c].nodes.filter(function(e){return e._id===i})[0]:e.props.nodes[i]),p=Object(r.get)(this.props.selectedNode,"type"),d=this.props.selectedNodeSchema?function(t){return t===g.c?function(t){var n=Object.assign({},t);return n.properties.tree.enumNames=Object(r.without)(n.properties.tree.enumNames,e.props.treeId),n.properties.tree.enum=Object(r.without)(n.properties.tree.enum,e.props.treeId),n}(e.props.selectedNodeSchema):t===g.d&&Object(r.has)(e.props.selectedNodeSchema,"properties.nodes")?function(e){var t=Object.assign({},e);if(delete t.properties.nodes,t.required)return $n({},t,{required:Object(r.pull)(t.required,"nodes")})}(e.props.selectedNodeSchema):$n({},e.props.selectedNodeSchema)}(p):void 0,f=!(!this.props.selectedNodeSchema||!this.props.selectedNode.id);return u.a.createElement(s.Fragment,null,u.a.createElement(Ct,{fluid:!0},u.a.createElement(Dt,null)),u.a.createElement(Q.n,{fluid:!0},u.a.createElement(Q.y,null,u.a.createElement(Nt,{isFullscreen:this.props.isFullscreen},u.a.createElement("div",{className:"authtree-container"},u.a.createElement(Ke,null),u.a.createElement("div",{className:$()({"authtree-content-centre":!0,"collapsed-right":f})},u.a.createElement(mt,{invertTooltipPlacement:this.props.isFullscreen,isDeleteNodeEnabled:!!this.props.selectedNode.id,onAutoLayout:this.props.onAutoLayout,onFullscreenToggle:this.props.onFullscreenToggle,onNodeDelete:this.handleNodeDelete,onTreeSave:this.props.onTreeSave}),u.a.createElement(oe.a,{onMeasure:this.handleTreeMeasure},u.a.createElement(Jn,{canvasHeight:o,canvasWidth:a,containerHeight:t,dimensions:this.props.dimensions,localNodeProperties:this.props.localNodeProperties,nodes:this.props.nodes,nodesInPages:this.props.nodesInPages,onNewConnection:this.props.onNewConnection,onNewNodeCreate:this.props.onNewNodeCreate,onNodeDeselect:this.props.onNodeDeselect,onNodeDimensionsChange:this.props.onNodeDimensionsChange,onNodeMove:this.props.onNodeMove,onNodePropertiesChange:this.props.onNodePropertiesChange,onNodeSelect:this.props.onNodeSelect,selectedNodeId:this.props.selectedNode.id}))),u.a.createElement(st,{isExpanded:f,isNew:this.props.selectedNodeIsNew,nodeId:this.props.selectedNode.id,nodeName:Object(r.get)(l,"displayName"),nodeType:this.props.selectedNode.type,onDisplayNameChange:this.props.onNodeDisplayNameChange,onFieldChange:this.props.onNodePropertiesFieldChange,onPropertiesChange:this.handleNodePropertiesChange,properties:this.props.selectedNodeProperties,schema:d}))))))}}])&&eo(n.prototype,o),a&&eo(n,a),t}();io.propTypes={dimensions:c.a.objectOf(c.a.object).isRequired,isFetching:c.a.bool.isRequired,isFullscreen:c.a.bool.isRequired,localNodeProperties:c.a.objectOf(c.a.shape({_type:c.a.shape({_id:c.a.string}).isRequired,nodes:c.a.arrayOf(c.a.shape({_id:c.a.string}))})).isRequired,nodes:c.a.objectOf(c.a.object).isRequired,nodesInPages:c.a.objectOf(c.a.string).isRequired,onAutoLayout:c.a.func.isRequired,onFullscreenToggle:c.a.func.isRequired,onNewConnection:c.a.func.isRequired,onNewNodeCreate:c.a.func.isRequired,onNodeDelete:c.a.func.isRequired,onNodeDeselect:c.a.func.isRequired,onNodeDimensionsChange:c.a.func.isRequired,onNodeDisplayNameChange:c.a.func.isRequired,onNodeMove:c.a.func.isRequired,onNodePropertiesChange:c.a.func.isRequired,onNodePropertiesFieldChange:c.a.func.isRequired,onNodeSelect:c.a.func.isRequired,onTreeSave:c.a.func.isRequired,selectedNode:c.a.shape({id:c.a.string,type:c.a.string}),selectedNodeIsNew:c.a.bool.isRequired,selectedNodeProperties:c.a.objectOf(c.a.any),selectedNodeSchema:c.a.objectOf(c.a.any),treeId:c.a.string.isRequired};var co=Object(J.DragDropContext)(te.a)(io);function so(e){return(so="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],o=!0,r=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(o=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);o=!0);}catch(e){r=!0,a=e}finally{try{o||null==c.return||c.return()}finally{if(r)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function lo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function po(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lo(n,!0).forEach(function(t){Oo(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lo(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function fo(e,t,n,o,r,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(o,r)}function bo(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var a=e.apply(t,n);function i(e){fo(a,o,r,i,c,"next",e)}function c(e){fo(a,o,r,i,c,"throw",e)}i(void 0)})}}function ho(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function yo(e){return(yo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function go(e,t){return(go=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var vo=function(e,t){return-1!==Object(r.chain)(e.nodes).values().map("connections").map(function(e){return Object(r.values)(e)}).flatten().value().indexOf(t)||e.entryNodeId===t},No=function(e){function t(){var e,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=yo(t).call(this),e=!o||"object"!==so(o)&&"function"!=typeof o?mo(n):o,Oo(mo(e),"performAutoLayout",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.props.dimensions,n=H(Object(r.findKey)(Object(g.j)(e.props.tree.entryNodeId)),Object(r.omit)(e.props.localNodes,Object(r.keys)(e.props.nodesInPages)),t);Object(r.each)(n,function(t,n){var o=t.x,r=t.y;e.props.handleNodeMove({x:o,y:r},n)})}),Oo(mo(e),"handleAutoLayout",function(){e.performAutoLayout(e.props.dimensions)}),Oo(mo(e),"handleFullscreenToggle",function(){e.setState({isFullscreen:!e.state.isFullscreen})}),Oo(mo(e),"handleTreeSave",bo(regeneratorRuntime.mark(function t(){var n,o,i,c,s,u,l,p,d,f,b,h,y,O,v,N,j,w;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.props.router.params[0],o={_type:{_id:"PageNode"}},i=Object(r.reject)(e.props.localNodeProperties,o),c=Object(r.filter)(e.props.localNodeProperties,o),u=(s=function(t){return Object(r.map)(t,function(){var t=bo(regeneratorRuntime.mark(function t(o){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P(n,o,o._type._id,o._id);case 2:r=t.sent,e.props.addNodeProperties.toRemote(r);case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())})(i),t.next=8,Promise.all(u);case 8:return l=s(c),t.next=11,Promise.all(l);case 11:return p=Object(r.omit)(e.props.localNodes,[g.a,Object(r.findKey)(Object(g.j)()),g.f].concat(Object(r.keys)(e.props.nodesInPages))),d={startNode:{x:e.props.localNodes.startNode.x,y:e.props.localNodes.startNode.y}},e.props.localNodes[g.f]&&(f=e.props.localNodes[g.f],b=f.x,h=f.y,d=po({},d,Oo({},g.f,{x:b,y:h}))),e.props.localNodes[g.a]&&(y=e.props.localNodes[g.a],O=y.x,v=y.y,d=po({},d,Oo({},g.a,{x:O,y:v}))),t.next=17,Object(m.f)(n,po({},e.props.tree,{nodes:p,staticNodes:d}),e.props.tree._id);case 17:return N=t.sent,j=Object(r.difference)(Object(r.keys)(e.props.remoteNodes),Object(r.union)(Object(r.keys)(e.props.nodesInPages),Object(r.keys)(e.props.localNodes))),w=Object(r.map)(j,function(t){return q(n,e.props.remoteNodes[t].nodeType,t).then(function(){e.props.removeNodePropertiesFromRemote(t)})}),e.props.updateTree.inRemote(N),e.props.setNodes.toRemote(N.nodes),e.setAllNodeProperties(n,N.nodes),t.next=25,Promise.all(w);case 25:xe.a.addMessage({message:Object(a.b)("config.messages.CommonMessages.changesSaved")});case 26:case"end":return t.stop()}},t)}))),Oo(mo(e),"handleNodeDimensionsChange",function(t,n,o){e.props.handleNodeDimensionsChange({id:t,height:n,width:o})}),Oo(mo(e),"handleNodeMove",function(t,n,o,i,c){var s=e.props.localNodeProperties[t],u=Object(r.get)(s,"_type._id"),l=t!==g.a&&t!==g.f&&t!==g.e&&u!==g.c&&u!==g.d;if(i&&c&&l){var p=yn.a.getState().local.config.realm.authentication.trees.current.nodes.pages.positions,d=Object(r.findKey)(p,function(e){return i>e.x&&i<e.x+e.width&&c>e.y&&c<e.y+e.height}),f=e.props.nodesInPages[t];if(d){if(f===d)return;return void(e.props.localNodes[d]._outcomes.length>1?xe.a.addMessage({message:Object(a.b)("console.authentication.trees.edit.nodes.pages.alreadyComplete"),type:xe.a.TYPE_DANGER}):(e.props.moveNodeToPage({nodeId:t,pageId:d}),e.loadOutcomes(d,g.d,e.props.localNodeProperties[d])))}f&&(e.props.moveNodeToTree(t),e.loadOutcomes(f,g.d,e.props.localNodeProperties[f]),e.loadOutcomes(t,u,s))}e.props.handleNodeMove({x:n,y:o},t)}),Oo(mo(e),"handleNewConnection",function(t,n,o){e.props.addOrUpdateConnection(Oo({},n,o),t),t===Object(r.findKey)(Object(g.j)())&&e.updateLocalEntryNodeId(o)}),Oo(mo(e),"handleNodePropertiesChange",function(t,n,o){if(e.props.nodesInPages[t]){var r=e.props.nodesInPages[t];e.handleNodePropertiesChange(r,g.d,e.props.localNodeProperties[r])}else e.loadOutcomes(t,n,o)}),Oo(mo(e),"handleNodeDelete",function(t){if(e.props.tree.entryNodeId===t&&e.updateLocalEntryNodeId(null),e.props.removeNode(t),e.props.nodesInPages[t]){var n=e.props.nodesInPages[t],o=e.props.localNodeProperties[n],a=po({},o,{nodes:Object(r.filter)(o.nodes,function(e){return e._id!==t})});e.props.removeNodeInPage(t),e.props.addNodeProperties.toLocal(a),e.handleNodePropertiesChange(n,g.d,a)}}),Oo(mo(e),"handleNodeSelect",function(t,n,o){e.props.handleNodeSelect({id:t,type:n});var r=!Object(g.i)(n)&&!e.props.localNodeProperties[t];if(n===g.d&&!e.props.nodeTypeSchema[g.d]||r){var a=e.props.router.params[0];S(a,n).then(V.a).then(function(t){return e.props.addNodeSchema(t,n)}),!e.props.remoteNodes[t]?C(a,n).then(function(r){e.props.addNodeProperties.toLocal(po({},r,{_id:t,_type:{_id:n,name:o}}))}):E(a,n,t).then(function(t){e.props.addNodeProperties.toRemote(t),e.props.addNodeProperties.toLocal(t)})}}),Oo(mo(e),"handleNodeDisplayNameChange",function(t,n){e.props.setNodeDisplayName({displayName:n,id:t})}),Oo(mo(e),"handleNewNode",function(t,n){var o;switch(t.nodeType){case g.g:o=g.f;break;case g.b:o=g.a;break;default:o=p()()}return e.props.addNode.toLocal(Oo({},o,po({},t,{_outcomes:[]}))),n&&e.props.handleNodeMove(n,o),Object(g.i)(t.nodeType)||(e.handleNodeSelect(o,t.nodeType,t.displayName),e.handleNodePropertiesChange(o,t.nodeType)),o}),Oo(mo(e),"loadOutcomes",function(t,n,o){var a=e.props.router.params[0],i=o&&n===g.d?{nodes:o.nodes.map(function(t){return po({},t,{_properties:e.props.localNodeProperties[t._id]})})}:o;R(a,i,n).then(function(n){var o=e.props.localNodes[t]._outcomes,a=Object(r.map)(o,"id"),i=Object(r.map)(n,"id");e.props.setNodeOutcomes(n,t),e.props.removeConnection(Object(r.difference)(a,i),t)})}),e.state={autoLayoutRequired:!0,isFetching:!0,isFullscreen:!1},e}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&go(e,t)}(t,s["Component"]),n=t,(o=[{key:"componentDidMount",value:function(){var e=this;this.props.removeCurrentTree();var t=uo(this.props.router.params,2),n=t[0],o=t[1];Object(m.b)(n,o).then(function(t){e.props.updateTree.inLocal(t),e.props.updateTree.inRemote(t);var n=Object(r.get)(t.staticNodes,g.e,{}),o=n.x,a=n.y,i=po({},t.nodes,{},Object(g.j)(t.entryNodeId,o,a));if(vo(t,g.f)||function(e,t){return e.entryNodeId===t}(t,g.a)){var c=Object(r.get)(t.staticNodes,g.f,{}),s=c.x,u=c.y;i=po({},i,{},Object(g.k)(s,u))}if(vo(t,g.a)){var l=Object(r.get)(t.staticNodes,g.a,{}),p=l.x,d=l.y;i=po({},i,{},Object(g.h)(p,d))}return e.props.setNodes.toLocal(i),e.props.setNodes.toRemote(t.nodes),t.nodes}).then(function(t){return e.setAllNodeProperties(n,t)}).finally(function(){e.setState({isFetching:!1})})}},{key:"componentDidUpdate",value:function(){if(this.state.autoLayoutRequired){var e,t=Object(r.sum)(Object(r.map)(this.props.localNodes,"x"))>0;e=this.props.dimensions,!Object(r.isEmpty)(e)&&Object(r.every)(e,function(e){var t=e.height,n=e.width;return t>0&&n>0})&&(t||this.performAutoLayout(),this.setState({autoLayoutRequired:!1}))}}},{key:"setAllNodeProperties",value:function(e,t){var n=this;return Promise.all(Object(r.toPairs)(t).filter(function(e){return uo(e,2)[1].nodeType===g.d}).map(function(t){var o=uo(t,2),r=o[0],a=o[1];return E(e,a.nodeType,r).then(function(e){n.props.addNodeProperties.toRemote(e),n.props.addNodeProperties.toLocal(e),e.nodes.forEach(function(e){n.props.addNodeInPage(e._id,r),n.props.addNode.toLocal(Oo({},e._id,e)),n.props.addNode.toRemote(Oo({},e._id,e))})})}))}},{key:"updateLocalEntryNodeId",value:function(e){this.props.updateTree.inLocal(po({},this.props.tree,{entryNodeId:e}))}},{key:"render",value:function(){var e=this.props.router.params[1],t=this.props.addNodeProperties.toLocal;return u.a.createElement(co,{dimensions:this.props.dimensions,isFetching:this.state.isFetching,isFullscreen:this.state.isFullscreen,localNodeProperties:this.props.localNodeProperties,nodes:this.props.localNodes,nodesInPages:this.props.nodesInPages,onAutoLayout:this.handleAutoLayout,onFullscreenToggle:this.handleFullscreenToggle,onNewConnection:this.handleNewConnection,onNewNodeCreate:this.handleNewNode,onNodeDelete:this.handleNodeDelete,onNodeDeselect:this.props.handleNodeDeselect,onNodeDimensionsChange:this.handleNodeDimensionsChange,onNodeDisplayNameChange:this.handleNodeDisplayNameChange,onNodeMove:this.handleNodeMove,onNodePropertiesChange:this.handleNodePropertiesChange,onNodePropertiesFieldChange:t,onNodeSelect:this.handleNodeSelect,onTreeSave:this.handleTreeSave,selectedNode:this.props.selectedNode,selectedNodeIsNew:!this.props.remoteNodes[this.props.selectedNode.id],selectedNodeProperties:this.props.selectedNodeProperties,selectedNodeSchema:this.props.selectedNodeSchema,treeId:e})}}])&&ho(n.prototype,o),i&&ho(n,i),t}();No.propTypes={addNode:c.a.objectOf(c.a.func.isRequired).isRequired,addNodeInPage:c.a.func.isRequired,addNodeProperties:c.a.objectOf(c.a.func.isRequired).isRequired,addNodeSchema:c.a.func.isRequired,addOrUpdateConnection:c.a.func.isRequired,dimensions:c.a.objectOf(c.a.object).isRequired,handleNodeDeselect:c.a.func.isRequired,handleNodeDimensionsChange:c.a.func.isRequired,handleNodeMove:c.a.func.isRequired,handleNodeSelect:c.a.func.isRequired,localNodeProperties:c.a.objectOf(c.a.shape({_type:c.a.shape({_id:c.a.string}),nodes:c.a.arrayOf(c.a.string.isRequired)})).isRequired,localNodes:D.d.nodes,moveNodeToPage:c.a.func.isRequired,moveNodeToTree:c.a.func.isRequired,nodeTypeSchema:c.a.objectOf(c.a.object).isRequired,nodesInPages:c.a.objectOf(c.a.string).isRequired,remoteNodes:c.a.objectOf(c.a.object).isRequired,removeConnection:c.a.func.isRequired,removeCurrentTree:c.a.func.isRequired,removeNode:c.a.func.isRequired,removeNodeInPage:c.a.func.isRequired,removeNodePropertiesFromRemote:c.a.func.isRequired,router:Me.a,selectedNode:c.a.shape({id:c.a.string,type:c.a.string}),selectedNodeProperties:c.a.objectOf(c.a.any),selectedNodeSchema:c.a.objectOf(c.a.any),setNodeDisplayName:c.a.func.isRequired,setNodeOutcomes:c.a.func.isRequired,setNodes:c.a.objectOf(c.a.func.isRequired).isRequired,tree:c.a.shape({_id:c.a.string.isRequired,entryNodeId:c.a.string}),updateTree:c.a.objectOf(c.a.func.isRequired).isRequired},No=Object(G.a)(No,function(e,t){var n=t.router.params[1],o=e.local.config.realm.authentication.trees.current.nodes.selected,r=e.local.config.realm.authentication.trees.current.nodes.properties;return{localNodeProperties:r,localNodes:e.local.config.realm.authentication.trees.current.tree.nodes,dimensions:e.local.config.realm.authentication.trees.current.nodes.dimensions,nodeTypeSchema:e.remote.config.realm.authentication.trees.nodeTypes.schema,nodesInPages:e.local.config.realm.authentication.trees.current.nodes.pages.childnodes,remoteNodes:e.remote.config.realm.authentication.trees.current.tree,selectedNode:o,selectedNodeProperties:r[o.id],selectedNodeSchema:e.remote.config.realm.authentication.trees.nodeTypes.schema[o.type],tree:e.local.config.realm.authentication.trees.list[n]}},function(e){return{addNodeInPage:Object(o.a)(k.a,e),addNodeProperties:Object(o.a)({toRemote:f.a,toLocal:d.a},e),addNodeSchema:Object(o.a)(y.a,e),addNode:Object(o.a)({toRemote:_.a,toLocal:D.b},e),addOrUpdateConnection:Object(o.a)(D.a,e),handleNodeDeselect:Object(o.a)(I.c,e),handleNodeDimensionsChange:Object(o.a)(x.c,e),handleNodeMove:Object(o.a)(D.h,e),handleNodeSelect:Object(o.a)(I.d,e),moveNodeToPage:Object(o.a)(T.b,e),moveNodeToTree:Object(o.a)(T.c,e),removeConnection:Object(o.a)(D.e,e),removeCurrentTree:Object(o.a)(T.d,e),removeNode:Object(o.a)(T.e,e),removeNodeInPage:Object(o.a)(k.d,e),removeNodePropertiesFromRemote:Object(o.a)(f.c,e),setNodeDisplayName:Object(o.a)(T.f,e),setNodeOutcomes:Object(o.a)(D.g,e),setNodes:Object(o.a)({toRemote:_.c,toLocal:D.f},e),updateTree:Object(o.a)({inRemote:h.a,inLocal:b.a},e)}}),No=Object(ke.a)(No);t.default=No}}]);
//# sourceMappingURL=70.9c99ade8f5.js.map